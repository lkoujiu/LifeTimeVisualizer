<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Grid - Visualize Your Time (Stacked)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        /* --- CSS Color Variables --- */
        :root {
            /* --- Light (Calm) Theme (Default) --- */
            --bg-color: #f9fafb; /* gray-50 */
            --text-color: #1f2937; /* gray-800 */
            --text-muted-color: #6b7280; /* gray-500 */
            --heading-color: #111827; /* gray-900 */
            --link-color: #2563eb; /* blue-600 */
            --link-hover-color: #1d4ed8; /* blue-700 */
            --tile-bg: #ffffff; /* white */
            --tile-border: #e5e7eb; /* gray-200 */
            --tile-shadow: rgba(0,0,0,0.05);
            --tile-hover-shadow: rgba(0,0,0,0.1);
            --tile-label-color: #64748b; /* slate-500 */
            --tile-value-color: #1e90ff; /* dodgerblue */
            --tile-past-bg: #4b5563; /* gray-600 */ /* Used for past hours */
            --tile-past-text: #ffffff;
            --tile-past-border: #374151; /* gray-700 */
            --tile-current-bg: #1e90ff; /* dodgerblue */ /* Used for current year/hour tile */
            --tile-current-text: #ffffff;
            --tile-current-border: #1c86ee; /* darker dodgerblue */
            --tile-upcoming-bg: #fef9c3; /* yellow-100 */ /* Used for upcoming year tiles (no longer used in this version) */
            --tile-upcoming-text: #a16207; /* yellow-800 */
            --tile-upcoming-border: #fde047; /* yellow-300 */
            --tile-future-bg: #e0f2fe; /* sky-100 */ /* Used for future year tiles (no longer used in this version) */
            --tile-future-text: #075985; /* sky-800 */
            --tile-future-border: #bae6fd; /* sky-200 */
            /* --- Prime Colors --- */
            --progress-text-prime: #9a3412; /* orange-800 - Matches prime gradient */
            /* --- --- */
            --contrib-square-bg: #e5e7eb; /* gray-200 */
            --contrib-square-border: #d1d5db; /* gray-300 */
            --contrib-current-border: #1e90ff; /* dodgerblue */ /* Outline for current month in progress grids */
            --progress-text-lifespan: #4338ca; /* indigo-700 - Matches lifespan gradient */
            --button-bg: #2563eb; /* blue-600 */
            --button-text: #ffffff;
            --button-hover-bg: #1d4ed8; /* blue-700 */
            --button-cancel-bg: #e5e7eb; /* gray-200 */
            --button-cancel-text: #374151; /* gray-700 */
            --button-cancel-hover-bg: #d1d5db; /* gray-300 */
            --input-border: #d1d5db; /* gray-300 */
            --input-focus-ring: #3b82f6; /* blue-500 */
            --input-text: #1f2937; /* gray-800 */
            --input-bg: #ffffff;
            --icon-color: #2563eb; /* blue-600 */
            --section-bg: #ffffff;
            --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); /* shadow-md */
            --theme-button-bg: #e5e7eb; /* gray-200 */
            --theme-button-icon-color: #374151; /* gray-700 */
            --theme-button-hover-bg: #d1d5db; /* gray-300 */
            --theme-button-active-bg: #9ca3af; /* gray-400 */
            --theme-button-active-icon-color: #ffffff;
            --theme-button-active-outline: var(--tile-selected-outline); /* Re-using selected tile outline color */
            --icon-tick-color: #10b981; /* emerald-500 */
            --icon-cross-color: #ef4444; /* red-500 */
            --modal-bg: #ffffff;
            --modal-overlay-bg: rgba(0, 0, 0, 0.5);
            --modal-border: #d1d5db; /* gray-300 */
            --modal-close-icon-color: #6b7280; /* gray-500 */
            --modal-close-icon-hover-bg: #e5e7eb; /* gray-200 */
            --settings-icon-color: #6b7280; /* gray-500 */
            --settings-icon-hover-bg: #f3f4f6; /* gray-100 */

            /* --- GRADIENTS --- */
            /* Gradient Fill Colors - Lifespan (Blues -> Purples -> Pinks -> Oranges) 20 steps */
            --contrib-lifespan-fill-1: #e0f2fe; --contrib-lifespan-fill-2: #bfdbfe; --contrib-lifespan-fill-3: #93c5fd; --contrib-lifespan-fill-4: #60a5fa; --contrib-lifespan-fill-5: #c7d2fe; --contrib-lifespan-fill-6: #a5b4fc; --contrib-lifespan-fill-7: #818cf8; --contrib-lifespan-fill-8: #ddd6fe; --contrib-lifespan-fill-9: #c4b5fd; --contrib-lifespan-fill-10: #a78bfa; --contrib-lifespan-fill-11: #f5d0fe; --contrib-lifespan-fill-12: #f0abfc; --contrib-lifespan-fill-13: #e879f9; --contrib-lifespan-fill-14: #fbcfe8; --contrib-lifespan-fill-15: #f9a8d4; --contrib-lifespan-fill-16: #f472b6; --contrib-lifespan-fill-17: #fed7aa; --contrib-lifespan-fill-18: #fdbb74; --contrib-lifespan-fill-19: #fb923c; --contrib-lifespan-fill-20: #f87171;
            /* Gradient Fill Colors - Prime (Yellows -> Oranges -> Reds) 20 steps */
            --contrib-prime-fill-1: #fef9c3; --contrib-prime-fill-2: #fef3c7; --contrib-prime-fill-3: #fde68a; --contrib-prime-fill-4: #fde047; --contrib-prime-fill-5: #facc15; --contrib-prime-fill-6: #fef3c7; --contrib-prime-fill-7: #fde68a; --contrib-prime-fill-8: #fcd34d; --contrib-prime-fill-9: #fbbf24; --contrib-prime-fill-10: #f59e0b; --contrib-prime-fill-11: #ffedd5; --contrib-prime-fill-12: #fed7aa; --contrib-prime-fill-13: #fdbb74; --contrib-prime-fill-14: #fb923c; --contrib-prime-fill-15: #f97316; --contrib-prime-fill-16: #fee2e2; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fca5a5; --contrib-prime-fill-19: #f87171; --contrib-prime-fill-20: #ef4444;
            /* Unit Grid Gradient Fill - Weeks (Cyans) 15 steps */
            --unit-week-fill-1: #ecfeff; --unit-week-fill-2: #cffafe; --unit-week-fill-3: #a5f3fc; --unit-week-fill-4: #67e8f9; --unit-week-fill-5: #22d3ee; --unit-week-fill-6: #06b6d4; --unit-week-fill-7: #0891b2; --unit-week-fill-8: #0e7490; --unit-week-fill-9: #155e75; --unit-week-fill-10: #164e63; --unit-week-fill-11: #083344; --unit-week-fill-12: #083344; --unit-week-fill-13: #083344; --unit-week-fill-14: #083344; --unit-week-fill-15: #083344;
            /* Unit Grid Gradient Fill - Months (Greens) 15 steps */
            --unit-month-fill-1: #f0fdf4; --unit-month-fill-2: #dcfce7; --unit-month-fill-3: #bbf7d0; --unit-month-fill-4: #86efac; --unit-month-fill-5: #4ade80; --unit-month-fill-6: #22c55e; --unit-month-fill-7: #16a34a; --unit-month-fill-8: #15803d; --unit-month-fill-9: #166534; --unit-month-fill-10: #14532d; --unit-month-fill-11: #052e16; --unit-month-fill-12: #052e16; --unit-month-fill-13: #052e16; --unit-month-fill-14: #052e16; --unit-month-fill-15: #052e16;
            /* Unit Grid Gradient Fill - Hours (Oranges) 15 steps */
            --unit-hour-fill-1: #fff7ed; --unit-hour-fill-2: #ffedd5; --unit-hour-fill-3: #fed7aa; --unit-hour-fill-4: #fdbb74; --unit-hour-fill-5: #fb923c; --unit-hour-fill-6: #f97316; --unit-hour-fill-7: #ea580c; --unit-hour-fill-8: #c2410c; --unit-hour-fill-9: #9a3412; --unit-hour-fill-10: #7c2d12; --unit-hour-fill-11: #451a03; --unit-hour-fill-12: #451a03; --unit-hour-fill-13: #451a03; --unit-hour-fill-14: #451a03; --unit-hour-fill-15: #451a03;
            /* Unit Grid Gradient Fill - Prime Years (Purples) 15 steps */
            --unit-primeYear-fill-1: #f5f3ff; --unit-primeYear-fill-2: #ede9fe; --unit-primeYear-fill-3: #ddd6fe; --unit-primeYear-fill-4: #c4b5fd; --unit-primeYear-fill-5: #a78bfa; --unit-primeYear-fill-6: #8b5cf6; --unit-primeYear-fill-7: #7c3aed; --unit-primeYear-fill-8: #6d28d9; --unit-primeYear-fill-9: #5b21b6; --unit-primeYear-fill-10: #4c1d95; --unit-primeYear-fill-11: #2e1065; --unit-primeYear-fill-12: #2e1065; --unit-primeYear-fill-13: #2e1065; --unit-primeYear-fill-14: #2e1065; --unit-primeYear-fill-15: #2e1065;
            /* Unit Grid Gradient Fill - Awake Slots (Greens) 15 steps */
            --unit-awakeSlot-fill-1: #f0fdf4; --unit-awakeSlot-fill-2: #dcfce7; --unit-awakeSlot-fill-3: #bbf7d0; --unit-awakeSlot-fill-4: #86efac; --unit-awakeSlot-fill-5: #4ade80; --unit-awakeSlot-fill-6: #22c55e; --unit-awakeSlot-fill-7: #16a34a; --unit-awakeSlot-fill-8: #15803d; --unit-awakeSlot-fill-9: #166534; --unit-awakeSlot-fill-10: #14532d; --unit-awakeSlot-fill-11: #052e16; --unit-awakeSlot-fill-12: #052e16; --unit-awakeSlot-fill-13: #052e16; --unit-awakeSlot-fill-14: #052e16; --unit-awakeSlot-fill-15: #052e16;
            /* NEW: Unit Grid Gradient Fill - Day Slots (Purples) 15 steps */
            --unit-daySlot-fill-1: #f5f3ff; --unit-daySlot-fill-2: #ede9fe; --unit-daySlot-fill-3: #ddd6fe; --unit-daySlot-fill-4: #c4b5fd; --unit-daySlot-fill-5: #a78bfa; --unit-daySlot-fill-6: #8b5cf6; --unit-daySlot-fill-7: #7c3aed; --unit-daySlot-fill-8: #6d28d9; --unit-daySlot-fill-9: #5b21b6; --unit-daySlot-fill-10: #4c1d95; --unit-daySlot-fill-11: #3730a3; --unit-daySlot-fill-12: #312e81; --unit-daySlot-fill-13: #2e1065; --unit-daySlot-fill-14: #2e1065; --unit-daySlot-fill-15: #2e1065;
            /* Unit Grid Current Hour/Upcoming Unit Highlight */
            --unit-current-bg: var(--tile-current-bg);
            --unit-current-border: var(--tile-current-border);
        }
            
        body.dark-mode {
            /* --- Dark Theme Variables --- */
            --bg-color: #111827; --text-color: #d1d5db; --text-muted-color: #9ca3af; --heading-color: #f9fafb; --link-color: #60a5fa; --link-hover-color: #93c5fd; --tile-bg: #1f2937; --tile-border: #374151; --tile-shadow: rgba(0,0,0,0.2); --tile-hover-shadow: rgba(0,0,0,0.3); --tile-label-color: #9ca3af; --tile-value-color: #60a5fa; --tile-past-bg: #4b5563; --tile-past-text: #f3f4f6; --tile-past-border: #374151; --tile-current-bg: #2563eb; --tile-current-text: #ffffff; --tile-current-border: #1d4ed8; --tile-upcoming-bg: #451a03; --tile-upcoming-text: #fef3c7; --tile-upcoming-border: #78350f; --tile-future-bg: #1e3a8a; --tile-future-text: #dbeafe; --tile-future-border: #1e40af;
            /* --- Prime Colors --- */
            --progress-text-prime: #fca5a5;
            /* --- --- */
            --contrib-square-bg: #374151; --contrib-square-border: #4b5563; --contrib-current-border: #60a5fa; --progress-text-lifespan: #a5b4fc; --button-bg: #3b82f6; --button-text: #ffffff; --button-hover-bg: #60a5fa; --button-cancel-bg: #374151; --button-cancel-text: #d1d5db; --button-cancel-hover-bg: #4b5563; --input-border: #4b5563; --input-focus-ring: #60a5fa; --input-text: #f3f4f6; --input-bg: #1f2937; --icon-color: #60a5fa; --section-bg: #1f2937; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2); --theme-button-bg: #374151; --theme-button-icon-color: #d1d5db; --theme-button-hover-bg: #4b5563; --theme-button-active-bg: #6b7280; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #818cf8; --icon-tick-color: #34d399; --icon-cross-color: #f87171; --modal-bg: #1f2937; --modal-overlay-bg: rgba(0, 0, 0, 0.7); --modal-border: #374151; --modal-close-icon-color: #9ca3af; --modal-close-icon-hover-bg: #374151; --settings-icon-color: #9ca3af; --settings-icon-hover-bg: #374151;

            /* --- GRADIENTS --- */
            /* Gradient Fill Colors - Lifespan (Blues -> Purples -> Pinks -> Roses) 20 steps */
            --contrib-lifespan-fill-1: #0c4a6e; --contrib-lifespan-fill-2: #075985; --contrib-lifespan-fill-3: #0369a1; --contrib-lifespan-fill-4: #0284c7; --contrib-lifespan-fill-5: #1e3a8a; --contrib-lifespan-fill-6: #1e40af; --contrib-lifespan-fill-7: #1d4ed8; --contrib-lifespan-fill-8: #312e81; --contrib-lifespan-fill-9: #3730a3; --contrib-lifespan-fill-10: #4338ca; --contrib-lifespan-fill-11: #5b21b6; --contrib-lifespan-fill-12: #6d28d9; --contrib-lifespan-fill-13: #7c3aed; --contrib-lifespan-fill-14: #a21caf; --contrib-lifespan-fill-15: #be185d; --contrib-lifespan-fill-16: #db2777; --contrib-lifespan-fill-17: #be123c; --contrib-lifespan-fill-18: #e11d48; --contrib-lifespan-fill-19: #f43f5e; --contrib-lifespan-fill-20: #fb7185;
            /* Gradient Fill Colors - Prime (Yellows -> Oranges -> Reds) 20 steps */
            --contrib-prime-fill-1: #713f12; --contrib-prime-fill-2: #854d0e; --contrib-prime-fill-3: #a16207; --contrib-prime-fill-4: #ca8a04; --contrib-prime-fill-5: #eab308; --contrib-prime-fill-6: #7c2d12; --contrib-prime-fill-7: #9a3412; --contrib-prime-fill-8: #b45309; --contrib-prime-fill-9: #d97706; --contrib-prime-fill-10: #ea580c; --contrib-prime-fill-11: #991b1b; --contrib-prime-fill-12: #b91c1c; --contrib-prime-fill-13: #dc2626; --contrib-prime-fill-14: #ef4444; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #fca5a5; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fee2e2; --contrib-prime-fill-19: #ffedd5; --contrib-prime-fill-20: #fef3c7;
            /* Unit Grid Gradient Fill - Weeks (Blues) 15 steps */
            --unit-week-fill-1: #0c4a6e; --unit-week-fill-2: #075985; --unit-week-fill-3: #0369a1; --unit-week-fill-4: #0284c7; --unit-week-fill-5: #0ea5e9; --unit-week-fill-6: #38bdf8; --unit-week-fill-7: #7dd3fc; --unit-week-fill-8: #bae6fd; --unit-week-fill-9: #e0f2fe; --unit-week-fill-10: #f0f9ff; --unit-week-fill-11: #f0f9ff; --unit-week-fill-12: #f0f9ff; --unit-week-fill-13: #f0f9ff; --unit-week-fill-14: #f0f9ff; --unit-week-fill-15: #f0f9ff;
            /* Unit Grid Gradient Fill - Months (Teals) 15 steps */
            --unit-month-fill-1: #134e4a; --unit-month-fill-2: #115e59; --unit-month-fill-3: #0f766e; --unit-month-fill-4: #0d9488; --unit-month-fill-5: #14b8a6; --unit-month-fill-6: #2dd4bf; --unit-month-fill-7: #5eead4; --unit-month-fill-8: #99f6e4; --unit-month-fill-9: #ccfbf1; --unit-month-fill-10: #f0fdfa; --unit-month-fill-11: #f0fdfa; --unit-month-fill-12: #f0fdfa; --unit-month-fill-13: #f0fdfa; --unit-month-fill-14: #f0fdfa; --unit-month-fill-15: #f0fdfa;
            /* Unit Grid Gradient Fill - Hours (Yellows/Ambers) 15 steps */
            --unit-hour-fill-1: #78350f; --unit-hour-fill-2: #92400e; --unit-hour-fill-3: #a16207; --unit-hour-fill-4: #b45309; --unit-hour-fill-5: #ca8a04; --unit-hour-fill-6: #d97706; --unit-hour-fill-7: #eab308; --unit-hour-fill-8: #f59e0b; --unit-hour-fill-9: #facc15; --unit-hour-fill-10: #fbbf24; --unit-hour-fill-11: #fcd34d; --unit-hour-fill-12: #fde68a; --unit-hour-fill-13: #fef3c7; --unit-hour-fill-14: #fef9c3; --unit-hour-fill-15: #fffbeb;
            /* Unit Grid Gradient Fill - Prime Years (Indigos) 15 steps */
            --unit-primeYear-fill-1: #312e81; --unit-primeYear-fill-2: #3730a3; --unit-primeYear-fill-3: #4338ca; --unit-primeYear-fill-4: #4f46e5; --unit-primeYear-fill-5: #6366f1; --unit-primeYear-fill-6: #818cf8; --unit-primeYear-fill-7: #a5b4fc; --unit-primeYear-fill-8: #c7d2fe; --unit-primeYear-fill-9: #e0e7ff; --unit-primeYear-fill-10: #eef2ff; --unit-primeYear-fill-11: #eef2ff; --unit-primeYear-fill-12: #eef2ff; --unit-primeYear-fill-13: #eef2ff; --unit-primeYear-fill-14: #eef2ff; --unit-primeYear-fill-15: #eef2ff;
            /* Unit Grid Gradient Fill - Awake Slots (Emeralds) 15 steps */
            --unit-awakeSlot-fill-1: #064e3b; --unit-awakeSlot-fill-2: #065f46; --unit-awakeSlot-fill-3: #047857; --unit-awakeSlot-fill-4: #059669; --unit-awakeSlot-fill-5: #10b981; --unit-awakeSlot-fill-6: #34d399; --unit-awakeSlot-fill-7: #6ee7b7; --unit-awakeSlot-fill-8: #a7f3d0; --unit-awakeSlot-fill-9: #d1fae5; --unit-awakeSlot-fill-10: #ecfdf5; --unit-awakeSlot-fill-11: #ecfdf5; --unit-awakeSlot-fill-12: #ecfdf5; --unit-awakeSlot-fill-13: #ecfdf5; --unit-awakeSlot-fill-14: #ecfdf5; --unit-awakeSlot-fill-15: #ecfdf5;
            /* NEW: Unit Grid Gradient Fill - Day Slots (Purples) 15 steps */
            --unit-daySlot-fill-1: #3730a3; --unit-daySlot-fill-2: #4338ca; --unit-daySlot-fill-3: #4f46e5; --unit-daySlot-fill-4: #6366f1; --unit-daySlot-fill-5: #818cf8; --unit-daySlot-fill-6: #a5b4fc; --unit-daySlot-fill-7: #c7d2fe; --unit-daySlot-fill-8: #e0e7ff; --unit-daySlot-fill-9: #eef2ff; --unit-daySlot-fill-10: #eef2ff; --unit-daySlot-fill-11: #eef2ff; --unit-daySlot-fill-12: #eef2ff; --unit-daySlot-fill-13: #eef2ff; --unit-daySlot-fill-14: #eef2ff; --unit-daySlot-fill-15: #eef2ff;
            /* Unit Grid Current Hour/Upcoming Unit Highlight */
            --unit-current-bg: var(--tile-current-bg);
            --unit-current-border: var(--tile-current-border);
        }

        body.colorful-mode {
            /* --- Kid-friendly colorful theme --- */
            --bg-color: #f0fdfa; --text-color: #115e59; --text-muted-color: #0e7490; --heading-color: #155e75; --link-color: #5b21b6; --link-hover-color: #6d28d9; --tile-bg: #ffffff; --tile-border: #67e8f9; --tile-shadow: rgba(6, 182, 212, 0.15); --tile-hover-shadow: rgba(6, 182, 212, 0.25); --tile-label-color: #0e7490; --tile-value-color: #5b21b6; --tile-past-bg: #fda4af; --tile-past-text: #881337; --tile-past-border: #fb7185; --tile-current-bg: #fde047; --tile-current-text: #854d0e; --tile-current-border: #facc15; --tile-upcoming-bg: #a7f3d0; --tile-upcoming-text: #065f46; --tile-upcoming-border: #6ee7b7; --tile-future-bg: #c4b5fd; --tile-future-text: #4c1d95; --tile-future-border: #a78bfa;
            /* --- Prime Colors --- */
            --progress-text-prime: #ef4444;
            /* --- --- */
            --contrib-square-bg: #e0f2fe; --contrib-square-border: #bae6fd; --contrib-current-border: #fde047; --progress-text-lifespan: #d946ef; --button-bg: #34d399; --button-text: #064e3b; --button-hover-bg: #6ee7b7; --button-cancel-bg: #fda4af; --button-cancel-text: #881337; --button-cancel-hover-bg: #fb7185; --input-border: #a5b4fc; --input-focus-ring: #818cf8; --input-text: #312e81; --input-bg: #ffffff; --icon-color: #6d28d9; --section-bg: #ffffff; --section-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); --theme-button-bg: #fde047; --theme-button-icon-color: #854d0e; --theme-button-hover-bg: #facc15; --theme-button-active-bg: #fb923c; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #16a34a; --icon-tick-color: #059669; --icon-cross-color: #e11d48; --modal-bg: #ecfdf5; --modal-overlay-bg: rgba(6, 78, 59, 0.6); --modal-border: #6ee7b7; --modal-close-icon-color: #065f46; --modal-close-icon-hover-bg: #a7f3d0; --settings-icon-color: #0e7490; --settings-icon-hover-bg: #a5f3fc;
            /* Subtle background pattern */
            background-color: var(--bg-color); background-image: radial-gradient(var(--dot-color) 1px, transparent 1px); background-size: 15px 15px; --dot-color: rgba(6, 182, 212, 0.1);

            /* --- GRADIENTS --- */
            /* Gradient Fill Colors - Lifespan (Greens -> Cyans -> Blues -> Violets -> Fuchsias -> Roses) 20 steps */
            --contrib-lifespan-fill-1: #dcfce7; --contrib-lifespan-fill-2: #bbf7d0; --contrib-lifespan-fill-3: #86efac; --contrib-lifespan-fill-4: #a7f3d0; --contrib-lifespan-fill-5: #6ee7b7; --contrib-lifespan-fill-6: #a5f3fc; --contrib-lifespan-fill-7: #67e8f9; --contrib-lifespan-fill-8: #bae6fd; --contrib-lifespan-fill-9: #7dd3fc; --contrib-lifespan-fill-10: #bfdbfe; --contrib-lifespan-fill-11: #93c5fd; --contrib-lifespan-fill-12: #c4b5fd; --contrib-lifespan-fill-13: #a78bfa; --contrib-lifespan-fill-14: #f0abfc; --contrib-lifespan-fill-15: #e879f9; --contrib-lifespan-fill-16: #fbcfe8; --contrib-lifespan-fill-17: #f9a8d4; --contrib-lifespan-fill-18: #f472b6; --contrib-lifespan-fill-19: #fda4af; --contrib-lifespan-fill-20: #fb7185;
            /* Gradient Fill Colors - Prime (Yellows -> Limes -> Oranges -> Reds -> Pinks) 20 steps */
            --contrib-prime-fill-1: #fef9c3; --contrib-prime-fill-2: #fef08a; --contrib-prime-fill-3: #fde68a; --contrib-prime-fill-4: #fde047; --contrib-prime-fill-5: #e0f2fe; --contrib-prime-fill-6: #d9f99d; --contrib-prime-fill-7: #bef264; --contrib-prime-fill-8: #a3e635; --contrib-prime-fill-9: #fed7aa; --contrib-prime-fill-10: #fdbb74; --contrib-prime-fill-11: #fb923c; --contrib-prime-fill-12: #f97316; --contrib-prime-fill-13: #fecaca; --contrib-prime-fill-14: #fca5a5; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #ef4444; --contrib-prime-fill-17: #fbcfe8; --contrib-prime-fill-18: #f9a8d4; --contrib-prime-fill-19: #f472b6; --contrib-prime-fill-20: #ec4899;
            /* Unit Grid Gradient Fill - Weeks (Limes) 15 steps */
            --unit-week-fill-1: #f7fee7; --unit-week-fill-2: #ecfccb; --unit-week-fill-3: #d9f99d; --unit-week-fill-4: #bef264; --unit-week-fill-5: #a3e635; --unit-week-fill-6: #84cc16; --unit-week-fill-7: #65a30d; --unit-week-fill-8: #4d7c0f; --unit-week-fill-9: #3f6212; --unit-week-fill-10: #365314; --unit-week-fill-11: #1a2e05; --unit-week-fill-12: #1a2e05; --unit-week-fill-13: #1a2e05; --unit-week-fill-14: #1a2e05; --unit-week-fill-15: #1a2e05;
            /* Unit Grid Gradient Fill - Months (Emeralds) 15 steps */
            --unit-month-fill-1: #ecfdf5; --unit-month-fill-2: #d1fae5; --unit-month-fill-3: #a7f3d0; --unit-month-fill-4: #6ee7b7; --unit-month-fill-5: #34d399; --unit-month-fill-6: #10b981; --unit-month-fill-7: #059669; --unit-month-fill-8: #047857; --unit-month-fill-9: #065f46; --unit-month-fill-10: #064e3b; --unit-month-fill-11: #022c22; --unit-month-fill-12: #022c22; --unit-month-fill-13: #022c22; --unit-month-fill-14: #022c22; --unit-month-fill-15: #022c22;
            /* Unit Grid Gradient Fill - Hours (Pinks) 15 steps */
            --unit-hour-fill-1: #fdf2f8; --unit-hour-fill-2: #fce7f3; --unit-hour-fill-3: #fbcfe8; --unit-hour-fill-4: #f9a8d4; --unit-hour-fill-5: #f472b6; --unit-hour-fill-6: #ec4899; --unit-hour-fill-7: #db2777; --unit-hour-fill-8: #be185d; --unit-hour-fill-9: #9d174d; --unit-hour-fill-10: #831843; --unit-hour-fill-11: #500724; --unit-hour-fill-12: #500724; --unit-hour-fill-13: #500724; --unit-hour-fill-14: #500724; --unit-hour-fill-15: #500724;
            /* Unit Grid Gradient Fill - Prime Years (Violets) 15 steps */
            --unit-primeYear-fill-1: #f5f3ff; --unit-primeYear-fill-2: #ede9fe; --unit-primeYear-fill-3: #ddd6fe; --unit-primeYear-fill-4: #c4b5fd; --unit-primeYear-fill-5: #a78bfa; --unit-primeYear-fill-6: #8b5cf6; --unit-primeYear-fill-7: #7c3aed; --unit-primeYear-fill-8: #6d28d9; --unit-primeYear-fill-9: #5b21b6; --unit-primeYear-fill-10: #4c1d95; --unit-primeYear-fill-11: #2e1065; --unit-primeYear-fill-12: #2e1065; --unit-primeYear-fill-13: #2e1065; --unit-primeYear-fill-14: #2e1065; --unit-primeYear-fill-15: #2e1065;
            /* Unit Grid Gradient Fill - Awake Slots (Blues) 15 steps */
            --unit-awakeSlot-fill-1: #eff6ff; --unit-awakeSlot-fill-2: #dbeafe; --unit-awakeSlot-fill-3: #bfdbfe; --unit-awakeSlot-fill-4: #93c5fd; --unit-awakeSlot-fill-5: #60a5fa; --unit-awakeSlot-fill-6: #3b82f6; --unit-awakeSlot-fill-7: #2563eb; --unit-awakeSlot-fill-8: #1d4ed8; --unit-awakeSlot-fill-9: #1e40af; --unit-awakeSlot-fill-10: #1e3a8a; --unit-awakeSlot-fill-11: #172554; --unit-awakeSlot-fill-12: #172554; --unit-awakeSlot-fill-13: #172554; --unit-awakeSlot-fill-14: #172554; --unit-awakeSlot-fill-15: #172554;
             /* NEW: Unit Grid Gradient Fill - Day Slots (Teals) 15 steps */
            --unit-daySlot-fill-1: #f0fdfa; --unit-daySlot-fill-2: #ccfbf1; --unit-daySlot-fill-3: #99f6e4; --unit-daySlot-fill-4: #5eead4; --unit-daySlot-fill-5: #2dd4bf; --unit-daySlot-fill-6: #14b8a6; --unit-daySlot-fill-7: #0d9488; --unit-daySlot-fill-8: #0f766e; --unit-daySlot-fill-9: #115e59; --unit-daySlot-fill-10: #134e4a; --unit-daySlot-fill-11: #042f2e; --unit-daySlot-fill-12: #042f2e; --unit-daySlot-fill-13: #042f2e; --unit-daySlot-fill-14: #042f2e; --unit-daySlot-fill-15: #042f2e;
            /* Unit Grid Current Hour/Upcoming Unit Highlight */
            --unit-current-bg: var(--tile-current-bg);
            --unit-current-border: var(--tile-current-border);
        }
        body.dark-mode { --dot-color: rgba(255, 255, 255, 0.04); } /* Dark dot color */

        /* --- Cyberpunk Theme Variables --- */
        body.cyberpunk-mode {
            --bg-color: #0d0221; /* Deep indigo/purple */
            --text-color: #f0f0f0; /* Off-white */
            --text-muted-color: #a0a0c0; /* Muted purple/grey */
            --heading-color: #ff00ff; /* Bright magenta */
            --link-color: #00f0ff; /* Bright cyan */
            --link-hover-color: #ffffff; /* White */
            --tile-bg: rgba(10, 10, 30, 0.8); /* Dark translucent blue/purple */
            --tile-border: #ff00ff; /* Magenta border */
            --tile-shadow: 0 0 10px rgba(255, 0, 255, 0.5); /* Magenta glow */
            --tile-hover-shadow: 0 0 15px rgba(0, 240, 255, 0.6); /* Cyan glow on hover */
            --tile-label-color: #a0a0c0;
            --tile-value-color: #00f0ff; /* Bright cyan */
            --tile-past-bg: #3d0f57; /* Darker purple */
            --tile-past-text: #a0a0c0;
            --tile-past-border: #5a189a;
            --tile-current-bg: #00f0ff; /* Bright cyan */
            --tile-current-text: #0d0221; /* Dark background color for contrast */
            --tile-current-border: #ffffff; /* White border */
            --tile-upcoming-bg: #5f0f40; /* Dark magenta */
            --tile-upcoming-text: #ff80ff;
            --tile-upcoming-border: #9a031e;
            --tile-future-bg: #023047; /* Dark blue */
            --tile-future-text: #8ecae6;
            --tile-future-border: #219ebc;
            --progress-text-prime: #f4ff00; /* Neon yellow */
            --contrib-square-bg: #1a1a3a; /* Dark blue/purple */
            --contrib-square-border: #3a3a5a;
            --contrib-current-border: #00f0ff; /* Bright cyan */
            --progress-text-lifespan: #00ff80; /* Neon green */
            --button-bg: #ff00ff; /* Magenta */
            --button-text: #ffffff;
            --button-hover-bg: #ff40ff;
            --button-cancel-bg: #4a4a6a;
            --button-cancel-text: #c0c0e0;
            --button-cancel-hover-bg: #6a6a8a;
            --input-border: #ff00ff; /* Magenta */
            --input-focus-ring: #00f0ff; /* Cyan */
            --input-text: #f0f0f0;
            --input-bg: #1a1a3a;
            --icon-color: #00f0ff; /* Cyan */
            --section-bg: rgba(10, 10, 30, 0.7); /* Translucent */
            --section-shadow: 0 0 15px rgba(0, 240, 255, 0.3); /* Cyan glow */
            --theme-button-bg: #3a3a5a;
            --theme-button-icon-color: #c0c0e0;
            --theme-button-hover-bg: #4a4a6a;
            --theme-button-active-bg: #ff00ff; /* Magenta */
            --theme-button-active-icon-color: #ffffff;
            --theme-button-active-outline: #00f0ff; /* Cyan */
            --icon-tick-color: #00ff80; /* Neon green */
            --icon-cross-color: #ff4040; /* Neon red */
            --modal-bg: #0d0221;
            --modal-overlay-bg: rgba(0, 0, 20, 0.85);
            --modal-border: #ff00ff; /* Magenta */
            --modal-close-icon-color: #a0a0c0;
            --modal-close-icon-hover-bg: #3a3a5a;
            --settings-icon-color: #a0a0c0;
            --settings-icon-hover-bg: #3a3a5a;

            /* --- GRADIENTS (Cyberpunk) --- */
            /* Lifespan: Cyan -> Blue -> Purple -> Magenta */
            --contrib-lifespan-fill-1: #003f5c; --contrib-lifespan-fill-2: #005f8c; --contrib-lifespan-fill-3: #007fbc; --contrib-lifespan-fill-4: #00a0ec; --contrib-lifespan-fill-5: #00c0ff; --contrib-lifespan-fill-6: #2a00ff; --contrib-lifespan-fill-7: #4a20ff; --contrib-lifespan-fill-8: #6a40ff; --contrib-lifespan-fill-9: #8a60ff; --contrib-lifespan-fill-10: #aa80ff; --contrib-lifespan-fill-11: #5a189a; --contrib-lifespan-fill-12: #7b2cbf; --contrib-lifespan-fill-13: #9d4edd; --contrib-lifespan-fill-14: #c77dff; --contrib-lifespan-fill-15: #e0aaff; --contrib-lifespan-fill-16: #ff00ff; --contrib-lifespan-fill-17: #ff40ff; --contrib-lifespan-fill-18: #ff80ff; --contrib-lifespan-fill-19: #ffbfff; --contrib-lifespan-fill-20: #ffffff;
            /* Prime: Yellow -> Green -> Lime -> Bright Green */
            --contrib-prime-fill-1: #ffbf00; --contrib-prime-fill-2: #ffd000; --contrib-prime-fill-3: #ffe000; --contrib-prime-fill-4: #fff000; --contrib-prime-fill-5: #ffff00; --contrib-prime-fill-6: #dfff00; --contrib-prime-fill-7: #bfff00; --contrib-prime-fill-8: #9fff00; --contrib-prime-fill-9: #80ff00; --contrib-prime-fill-10: #60ff00; --contrib-prime-fill-11: #40ff00; --contrib-prime-fill-12: #20ff00; --contrib-prime-fill-13: #00ff00; --contrib-prime-fill-14: #00ff40; --contrib-prime-fill-15: #00ff80; --contrib-prime-fill-16: #00ffbf; --contrib-prime-fill-17: #00ffff; --contrib-prime-fill-18: #40ffff; --contrib-prime-fill-19: #80ffff; --contrib-prime-fill-20: #bffff;
            /* Unit Weeks: Bright Blues */
            --unit-week-fill-1: #003049; --unit-week-fill-2: #004c73; --unit-week-fill-3: #00679d; --unit-week-fill-4: #0083c7; --unit-week-fill-5: #009ef1; --unit-week-fill-6: #00baff; --unit-week-fill-7: #40c7ff; --unit-week-fill-8: #60d4ff; --unit-week-fill-9: #80e1ff; --unit-week-fill-10: #a0eeff; --unit-week-fill-11: #b0f4ff; --unit-week-fill-12: #c0faff; --unit-week-fill-13: #d0fcff; --unit-week-fill-14: #e0feff; --unit-week-fill-15: #f0ffff;
            /* Unit Months: Bright Greens */
            --unit-month-fill-1: #004b23; --unit-month-fill-2: #006430; --unit-month-fill-3: #007f3d; --unit-month-fill-4: #009a4a; --unit-month-fill-5: #00b557; --unit-month-fill-6: #00d064; --unit-month-fill-7: #00eb71; --unit-month-fill-8: #00ff80; --unit-month-fill-9: #30ff90; --unit-month-fill-10: #60ffa0; --unit-month-fill-11: #80ffb0; --unit-month-fill-12: #a0ffc0; --unit-month-fill-13: #b0ffd0; --unit-month-fill-14: #c0ffe0; --unit-month-fill-15: #d0fff0;
            /* Unit Hours: Bright Pinks/Magentas */
            --unit-hour-fill-1: #7a0177; --unit-hour-fill-2: #9c118b; --unit-hour-fill-3: #be219f; --unit-hour-fill-4: #e031b3; --unit-hour-fill-5: #f746c1; --unit-hour-fill-6: #ff5bcd; --unit-hour-fill-7: #ff70d9; --unit-hour-fill-8: #ff85e5; --unit-hour-fill-9: #ff9af1; --unit-hour-fill-10: #ffaffd; --unit-hour-fill-11: #ffc4ff; --unit-hour-fill-12: #ffd9ff; --unit-hour-fill-13: #ffeaff; --unit-hour-fill-14: #fff5ff; --unit-hour-fill-15: #ffffff;
            /* Unit Prime Years: Bright Yellows */
            --unit-primeYear-fill-1: #ffaa00; --unit-primeYear-fill-2: #ffb800; --unit-primeYear-fill-3: #ffc600; --unit-primeYear-fill-4: #ffd400; --unit-primeYear-fill-5: #ffe200; --unit-primeYear-fill-6: #fff000; --unit-primeYear-fill-7: #ffff30; --unit-primeYear-fill-8: #ffff60; --unit-primeYear-fill-9: #ffff80; --unit-primeYear-fill-10: #ffffa0; --unit-primeYear-fill-11: #ffffb0; --unit-primeYear-fill-12: #ffffc0; --unit-primeYear-fill-13: #ffffd0; --unit-primeYear-fill-14: #ffffe0; --unit-primeYear-fill-15: #fffff0;
            /* Unit Awake Slots: Bright Cyans */
            --unit-awakeSlot-fill-1: #008080; --unit-awakeSlot-fill-2: #009a9a; --unit-awakeSlot-fill-3: #00b4b4; --unit-awakeSlot-fill-4: #00cece; --unit-awakeSlot-fill-5: #00e8e8; --unit-awakeSlot-fill-6: #00ffff; --unit-awakeSlot-fill-7: #30ffff; --unit-awakeSlot-fill-8: #60ffff; --unit-awakeSlot-fill-9: #80ffff; --unit-awakeSlot-fill-10: #a0ffff; --unit-awakeSlot-fill-11: #b0ffff; --unit-awakeSlot-fill-12: #c0ffff; --unit-awakeSlot-fill-13: #d0ffff; --unit-awakeSlot-fill-14: #e0ffff; --unit-awakeSlot-fill-15: #f0ffff;
            /* Unit Day Slots: Bright Purples */
            --unit-daySlot-fill-1: #3a0ca3; --unit-daySlot-fill-2: #4a1fa7; --unit-daySlot-fill-3: #5a32ab; --unit-daySlot-fill-4: #6a45af; --unit-daySlot-fill-5: #7a58b3; --unit-daySlot-fill-6: #8a6bb7; --unit-daySlot-fill-7: #9a7ebb; --unit-daySlot-fill-8: #aa91bf; --unit-daySlot-fill-9: #baa4c3; --unit-daySlot-fill-10: #cab7c7; --unit-daySlot-fill-11: #dacacb; --unit-daySlot-fill-12: #eadcdf; --unit-daySlot-fill-13: #faeef3; --unit-daySlot-fill-14: #fbf5f7; --unit-daySlot-fill-15: #ffffff;
            --unit-current-bg: var(--tile-current-bg);
            --unit-current-border: var(--tile-current-border);
        }
        /* --- ADD THESE 7 THEME BLOCKS BELOW --- */

/* --- Dark Variant 1: Dark Ocean --- */
body.dark-ocean-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #0b132b; --text-color: #d1d5db; --text-muted-color: #9ca3af; --heading-color: #6fffe9; --link-color: #60a5fa; --link-hover-color: #93c5fd; --tile-bg: #1c2541; --tile-border: #3a506b; --tile-shadow: rgba(0,0,0,0.2); --tile-hover-shadow: rgba(0,0,0,0.3); --tile-label-color: #9ca3af; --tile-value-color: #6fffe9; --tile-past-bg: #4b5563; --tile-past-text: #f3f4f6; --tile-past-border: #374151; --tile-current-bg: #2563eb; --tile-current-text: #ffffff; --tile-current-border: #1d4ed8; --tile-upcoming-bg: #451a03; --tile-upcoming-text: #fef3c7; --tile-upcoming-border: #78350f; --tile-future-bg: #1e3a8a; --tile-future-text: #dbeafe; --tile-future-border: #1e40af;
    --progress-text-prime: #fca5a5;
    --contrib-square-bg: #374151; --contrib-square-border: #4b5563; --contrib-current-border: #60a5fa; --progress-text-lifespan: #a5b4fc; --button-bg: #3b82f6; --button-text: #ffffff; --button-hover-bg: #60a5fa; --button-cancel-bg: #374151; --button-cancel-text: #d1d5db; --button-cancel-hover-bg: #4b5563; --input-border: #4b5563; --input-focus-ring: #60a5fa; --input-text: #f3f4f6; --input-bg: #1f2937; --icon-color: #60a5fa; --section-bg: #1f2937; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2); --theme-button-bg: #374151; --theme-button-icon-color: #d1d5db; --theme-button-hover-bg: #4b5563; --theme-button-active-bg: #6b7280; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #818cf8; --icon-tick-color: #34d399; --icon-cross-color: #f87171; --modal-bg: #1f2937; --modal-overlay-bg: rgba(0, 0, 0, 0.7); --modal-border: #374151; --modal-close-icon-color: #9ca3af; --modal-close-icon-hover-bg: #374151; --settings-icon-color: #9ca3af; --settings-icon-hover-bg: #374151;
    /* --- GRADIENTS (Replace with theme-specific colors) --- */
    --contrib-lifespan-fill-1: #0c4a6e; --contrib-lifespan-fill-2: #075985; --contrib-lifespan-fill-3: #0369a1; --contrib-lifespan-fill-4: #0284c7; --contrib-lifespan-fill-5: #1e3a8a; --contrib-lifespan-fill-6: #1e40af; --contrib-lifespan-fill-7: #1d4ed8; --contrib-lifespan-fill-8: #312e81; --contrib-lifespan-fill-9: #3730a3; --contrib-lifespan-fill-10: #4338ca; --contrib-lifespan-fill-11: #5b21b6; --contrib-lifespan-fill-12: #6d28d9; --contrib-lifespan-fill-13: #7c3aed; --contrib-lifespan-fill-14: #a21caf; --contrib-lifespan-fill-15: #be185d; --contrib-lifespan-fill-16: #db2777; --contrib-lifespan-fill-17: #be123c; --contrib-lifespan-fill-18: #e11d48; --contrib-lifespan-fill-19: #f43f5e; --contrib-lifespan-fill-20: #fb7185;
    --contrib-prime-fill-1: #713f12; --contrib-prime-fill-2: #854d0e; --contrib-prime-fill-3: #a16207; --contrib-prime-fill-4: #ca8a04; --contrib-prime-fill-5: #eab308; --contrib-prime-fill-6: #7c2d12; --contrib-prime-fill-7: #9a3412; --contrib-prime-fill-8: #b45309; --contrib-prime-fill-9: #d97706; --contrib-prime-fill-10: #ea580c; --contrib-prime-fill-11: #991b1b; --contrib-prime-fill-12: #b91c1c; --contrib-prime-fill-13: #dc2626; --contrib-prime-fill-14: #ef4444; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #fca5a5; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fee2e2; --contrib-prime-fill-19: #ffedd5; --contrib-prime-fill-20: #fef3c7;
    --unit-week-fill-1: #0c4a6e; --unit-week-fill-2: #075985; --unit-week-fill-3: #0369a1; --unit-week-fill-4: #0284c7; --unit-week-fill-5: #0ea5e9; --unit-week-fill-6: #38bdf8; --unit-week-fill-7: #7dd3fc; --unit-week-fill-8: #bae6fd; --unit-week-fill-9: #e0f2fe; --unit-week-fill-10: #f0f9ff; --unit-week-fill-11: #f0f9ff; --unit-week-fill-12: #f0f9ff; --unit-week-fill-13: #f0f9ff; --unit-week-fill-14: #f0f9ff; --unit-week-fill-15: #f0f9ff;
    --unit-month-fill-1: #134e4a; --unit-month-fill-2: #115e59; --unit-month-fill-3: #0f766e; --unit-month-fill-4: #0d9488; --unit-month-fill-5: #14b8a6; --unit-month-fill-6: #2dd4bf; --unit-month-fill-7: #5eead4; --unit-month-fill-8: #99f6e4; --unit-month-fill-9: #ccfbf1; --unit-month-fill-10: #f0fdfa; --unit-month-fill-11: #f0fdfa; --unit-month-fill-12: #f0fdfa; --unit-month-fill-13: #f0fdfa; --unit-month-fill-14: #f0fdfa; --unit-month-fill-15: #f0fdfa;
    --unit-hour-fill-1: #78350f; --unit-hour-fill-2: #92400e; --unit-hour-fill-3: #a16207; --unit-hour-fill-4: #b45309; --unit-hour-fill-5: #ca8a04; --unit-hour-fill-6: #d97706; --unit-hour-fill-7: #eab308; --unit-hour-fill-8: #f59e0b; --unit-hour-fill-9: #facc15; --unit-hour-fill-10: #fbbf24; --unit-hour-fill-11: #fcd34d; --unit-hour-fill-12: #fde68a; --unit-hour-fill-13: #fef3c7; --unit-hour-fill-14: #fef9c3; --unit-hour-fill-15: #fffbeb;
    --unit-primeYear-fill-1: #312e81; --unit-primeYear-fill-2: #3730a3; --unit-primeYear-fill-3: #4338ca; --unit-primeYear-fill-4: #4f46e5; --unit-primeYear-fill-5: #6366f1; --unit-primeYear-fill-6: #818cf8; --unit-primeYear-fill-7: #a5b4fc; --unit-primeYear-fill-8: #c7d2fe; --unit-primeYear-fill-9: #e0e7ff; --unit-primeYear-fill-10: #eef2ff; --unit-primeYear-fill-11: #eef2ff; --unit-primeYear-fill-12: #eef2ff; --unit-primeYear-fill-13: #eef2ff; --unit-primeYear-fill-14: #eef2ff; --unit-primeYear-fill-15: #eef2ff;
    --unit-awakeSlot-fill-1: #064e3b; --unit-awakeSlot-fill-2: #065f46; --unit-awakeSlot-fill-3: #047857; --unit-awakeSlot-fill-4: #059669; --unit-awakeSlot-fill-5: #10b981; --unit-awakeSlot-fill-6: #34d399; --unit-awakeSlot-fill-7: #6ee7b7; --unit-awakeSlot-fill-8: #a7f3d0; --unit-awakeSlot-fill-9: #d1fae5; --unit-awakeSlot-fill-10: #ecfdf5; --unit-awakeSlot-fill-11: #ecfdf5; --unit-awakeSlot-fill-12: #ecfdf5; --unit-awakeSlot-fill-13: #ecfdf5; --unit-awakeSlot-fill-14: #ecfdf5; --unit-awakeSlot-fill-15: #ecfdf5;
    --unit-daySlot-fill-1: #3730a3; --unit-daySlot-fill-2: #4338ca; --unit-daySlot-fill-3: #4f46e5; --unit-daySlot-fill-4: #6366f1; --unit-daySlot-fill-5: #818cf8; --unit-daySlot-fill-6: #a5b4fc; --unit-daySlot-fill-7: #c7d2fe; --unit-daySlot-fill-8: #e0e7ff; --unit-daySlot-fill-9: #eef2ff; --unit-daySlot-fill-10: #eef2ff; --unit-daySlot-fill-11: #eef2ff; --unit-daySlot-fill-12: #eef2ff; --unit-daySlot-fill-13: #eef2ff; --unit-daySlot-fill-14: #eef2ff; --unit-daySlot-fill-15: #eef2ff;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(255, 255, 255, 0.04); /* Optional: Adjust dot color */
}

/* --- Dark Variant 2: Dark Forest --- */
body.dark-forest-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #1a2e05; --text-color: #d1d5db; --text-muted-color: #9ca3af; --heading-color: #bef264; --link-color: #60a5fa; --link-hover-color: #93c5fd; --tile-bg: #365314; --tile-border: #4d7c0f; --tile-shadow: rgba(0,0,0,0.2); --tile-hover-shadow: rgba(0,0,0,0.3); --tile-label-color: #9ca3af; --tile-value-color: #bef264; --tile-past-bg: #4b5563; --tile-past-text: #f3f4f6; --tile-past-border: #374151; --tile-current-bg: #22c55e; --tile-current-text: #ffffff; --tile-current-border: #16a34a; --tile-upcoming-bg: #451a03; --tile-upcoming-text: #fef3c7; --tile-upcoming-border: #78350f; --tile-future-bg: #1e3a8a; --tile-future-text: #dbeafe; --tile-future-border: #1e40af;
    --progress-text-prime: #fca5a5;
    --contrib-square-bg: #374151; --contrib-square-border: #4b5563; --contrib-current-border: #60a5fa; --progress-text-lifespan: #a5b4fc; --button-bg: #3b82f6; --button-text: #ffffff; --button-hover-bg: #60a5fa; --button-cancel-bg: #374151; --button-cancel-text: #d1d5db; --button-cancel-hover-bg: #4b5563; --input-border: #4b5563; --input-focus-ring: #60a5fa; --input-text: #f3f4f6; --input-bg: #1f2937; --icon-color: #60a5fa; --section-bg: #1f2937; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2); --theme-button-bg: #374151; --theme-button-icon-color: #d1d5db; --theme-button-hover-bg: #4b5563; --theme-button-active-bg: #6b7280; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #818cf8; --icon-tick-color: #34d399; --icon-cross-color: #f87171; --modal-bg: #1f2937; --modal-overlay-bg: rgba(0, 0, 0, 0.7); --modal-border: #374151; --modal-close-icon-color: #9ca3af; --modal-close-icon-hover-bg: #374151; --settings-icon-color: #9ca3af; --settings-icon-hover-bg: #374151;
    /* --- GRADIENTS (Replace with theme-specific colors) --- */
    --contrib-lifespan-fill-1: #0c4a6e; --contrib-lifespan-fill-2: #075985; --contrib-lifespan-fill-3: #0369a1; --contrib-lifespan-fill-4: #0284c7; --contrib-lifespan-fill-5: #1e3a8a; --contrib-lifespan-fill-6: #1e40af; --contrib-lifespan-fill-7: #1d4ed8; --contrib-lifespan-fill-8: #312e81; --contrib-lifespan-fill-9: #3730a3; --contrib-lifespan-fill-10: #4338ca; --contrib-lifespan-fill-11: #5b21b6; --contrib-lifespan-fill-12: #6d28d9; --contrib-lifespan-fill-13: #7c3aed; --contrib-lifespan-fill-14: #a21caf; --contrib-lifespan-fill-15: #be185d; --contrib-lifespan-fill-16: #db2777; --contrib-lifespan-fill-17: #be123c; --contrib-lifespan-fill-18: #e11d48; --contrib-lifespan-fill-19: #f43f5e; --contrib-lifespan-fill-20: #fb7185;
    --contrib-prime-fill-1: #713f12; --contrib-prime-fill-2: #854d0e; --contrib-prime-fill-3: #a16207; --contrib-prime-fill-4: #ca8a04; --contrib-prime-fill-5: #eab308; --contrib-prime-fill-6: #7c2d12; --contrib-prime-fill-7: #9a3412; --contrib-prime-fill-8: #b45309; --contrib-prime-fill-9: #d97706; --contrib-prime-fill-10: #ea580c; --contrib-prime-fill-11: #991b1b; --contrib-prime-fill-12: #b91c1c; --contrib-prime-fill-13: #dc2626; --contrib-prime-fill-14: #ef4444; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #fca5a5; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fee2e2; --contrib-prime-fill-19: #ffedd5; --contrib-prime-fill-20: #fef3c7;
    --unit-week-fill-1: #0c4a6e; --unit-week-fill-2: #075985; --unit-week-fill-3: #0369a1; --unit-week-fill-4: #0284c7; --unit-week-fill-5: #0ea5e9; --unit-week-fill-6: #38bdf8; --unit-week-fill-7: #7dd3fc; --unit-week-fill-8: #bae6fd; --unit-week-fill-9: #e0f2fe; --unit-week-fill-10: #f0f9ff; --unit-week-fill-11: #f0f9ff; --unit-week-fill-12: #f0f9ff; --unit-week-fill-13: #f0f9ff; --unit-week-fill-14: #f0f9ff; --unit-week-fill-15: #f0f9ff;
    --unit-month-fill-1: #134e4a; --unit-month-fill-2: #115e59; --unit-month-fill-3: #0f766e; --unit-month-fill-4: #0d9488; --unit-month-fill-5: #14b8a6; --unit-month-fill-6: #2dd4bf; --unit-month-fill-7: #5eead4; --unit-month-fill-8: #99f6e4; --unit-month-fill-9: #ccfbf1; --unit-month-fill-10: #f0fdfa; --unit-month-fill-11: #f0fdfa; --unit-month-fill-12: #f0fdfa; --unit-month-fill-13: #f0fdfa; --unit-month-fill-14: #f0fdfa; --unit-month-fill-15: #f0fdfa;
    --unit-hour-fill-1: #78350f; --unit-hour-fill-2: #92400e; --unit-hour-fill-3: #a16207; --unit-hour-fill-4: #b45309; --unit-hour-fill-5: #ca8a04; --unit-hour-fill-6: #d97706; --unit-hour-fill-7: #eab308; --unit-hour-fill-8: #f59e0b; --unit-hour-fill-9: #facc15; --unit-hour-fill-10: #fbbf24; --unit-hour-fill-11: #fcd34d; --unit-hour-fill-12: #fde68a; --unit-hour-fill-13: #fef3c7; --unit-hour-fill-14: #fef9c3; --unit-hour-fill-15: #fffbeb;
    --unit-primeYear-fill-1: #312e81; --unit-primeYear-fill-2: #3730a3; --unit-primeYear-fill-3: #4338ca; --unit-primeYear-fill-4: #4f46e5; --unit-primeYear-fill-5: #6366f1; --unit-primeYear-fill-6: #818cf8; --unit-primeYear-fill-7: #a5b4fc; --unit-primeYear-fill-8: #c7d2fe; --unit-primeYear-fill-9: #e0e7ff; --unit-primeYear-fill-10: #eef2ff; --unit-primeYear-fill-11: #eef2ff; --unit-primeYear-fill-12: #eef2ff; --unit-primeYear-fill-13: #eef2ff; --unit-primeYear-fill-14: #eef2ff; --unit-primeYear-fill-15: #eef2ff;
    --unit-awakeSlot-fill-1: #064e3b; --unit-awakeSlot-fill-2: #065f46; --unit-awakeSlot-fill-3: #047857; --unit-awakeSlot-fill-4: #059669; --unit-awakeSlot-fill-5: #10b981; --unit-awakeSlot-fill-6: #34d399; --unit-awakeSlot-fill-7: #6ee7b7; --unit-awakeSlot-fill-8: #a7f3d0; --unit-awakeSlot-fill-9: #d1fae5; --unit-awakeSlot-fill-10: #ecfdf5; --unit-awakeSlot-fill-11: #ecfdf5; --unit-awakeSlot-fill-12: #ecfdf5; --unit-awakeSlot-fill-13: #ecfdf5; --unit-awakeSlot-fill-14: #ecfdf5; --unit-awakeSlot-fill-15: #ecfdf5;
    --unit-daySlot-fill-1: #3730a3; --unit-daySlot-fill-2: #4338ca; --unit-daySlot-fill-3: #4f46e5; --unit-daySlot-fill-4: #6366f1; --unit-daySlot-fill-5: #818cf8; --unit-daySlot-fill-6: #a5b4fc; --unit-daySlot-fill-7: #c7d2fe; --unit-daySlot-fill-8: #e0e7ff; --unit-daySlot-fill-9: #eef2ff; --unit-daySlot-fill-10: #eef2ff; --unit-daySlot-fill-11: #eef2ff; --unit-daySlot-fill-12: #eef2ff; --unit-daySlot-fill-13: #eef2ff; --unit-daySlot-fill-14: #eef2ff; --unit-daySlot-fill-15: #eef2ff;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(255, 255, 255, 0.04); /* Optional: Adjust dot color */
}

/* --- Kids Variant 1: Kids Rainbow --- */
body.kids-rainbow-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    /* Example colors provided previously, adjust as needed */
    --bg-color: #f0f9ff; --text-color: #374151; --text-muted-color: #6b7280; --heading-color: #ec4899; --link-color: #8b5cf6; --link-hover-color: #7c3aed; --tile-bg: #ffffff; --tile-border: #fde047; --tile-shadow: rgba(0,0,0,0.05); --tile-hover-shadow: rgba(0,0,0,0.1); --tile-label-color: #64748b; --tile-value-color: #8b5cf6; --tile-past-bg: #fda4af; --tile-past-text: #881337; --tile-past-border: #fb7185; --tile-current-bg: #fde047; --tile-current-text: #854d0e; --tile-current-border: #facc15; --tile-upcoming-bg: #a7f3d0; --tile-upcoming-text: #065f46; --tile-upcoming-border: #6ee7b7; --tile-future-bg: #c4b5fd; --tile-future-text: #4c1d95; --tile-future-border: #a78bfa;
    --progress-text-prime: #ef4444;
    --contrib-square-bg: #e0f2fe; --contrib-square-border: #bae6fd; --contrib-current-border: #fde047; --progress-text-lifespan: #d946ef; --button-bg: #34d399; --button-text: #064e3b; --button-hover-bg: #6ee7b7; --button-cancel-bg: #fda4af; --button-cancel-text: #881337; --button-cancel-hover-bg: #fb7185; --input-border: #a5b4fc; --input-focus-ring: #818cf8; --input-text: #312e81; --input-bg: #ffffff; --icon-color: #6d28d9; --section-bg: #ffffff; --section-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); --theme-button-bg: #fde047; --theme-button-icon-color: #854d0e; --theme-button-hover-bg: #facc15; --theme-button-active-bg: #fb923c; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #16a34a; --icon-tick-color: #059669; --icon-cross-color: #e11d48; --modal-bg: #ecfdf5; --modal-overlay-bg: rgba(6, 78, 59, 0.6); --modal-border: #6ee7b7; --modal-close-icon-color: #065f46; --modal-close-icon-hover-bg: #a7f3d0; --settings-icon-color: #0e7490; --settings-icon-hover-bg: #a5f3fc;
    /* --- GRADIENTS (Use bright rainbow colors) --- */
    --contrib-lifespan-fill-1: #fecaca; --contrib-lifespan-fill-2: #fed7aa; --contrib-lifespan-fill-3: #fef08a; --contrib-lifespan-fill-4: #d9f99d; --contrib-lifespan-fill-5: #a7f3d0; --contrib-lifespan-fill-6: #a5f3fc; --contrib-lifespan-fill-7: #bae6fd; --contrib-lifespan-fill-8: #c7d2fe; --contrib-lifespan-fill-9: #ddd6fe; --contrib-lifespan-fill-10: #e9d5ff; --contrib-lifespan-fill-11: #f5d0fe; --contrib-lifespan-fill-12: #fbcfe8; --contrib-lifespan-fill-13: #fecaca; --contrib-lifespan-fill-14: #fed7aa; --contrib-lifespan-fill-15: #fef08a; --contrib-lifespan-fill-16: #d9f99d; --contrib-lifespan-fill-17: #a7f3d0; --contrib-lifespan-fill-18: #a5f3fc; --contrib-lifespan-fill-19: #bae6fd; --contrib-lifespan-fill-20: #c7d2fe;
    --contrib-prime-fill-1: #ef4444; --contrib-prime-fill-2: #f97316; --contrib-prime-fill-3: #f59e0b; --contrib-prime-fill-4: #eab308; --contrib-prime-fill-5: #84cc16; --contrib-prime-fill-6: #22c55e; --contrib-prime-fill-7: #10b981; --contrib-prime-fill-8: #06b6d4; --contrib-prime-fill-9: #0ea5e9; --contrib-prime-fill-10: #3b82f6; --contrib-prime-fill-11: #6366f1; --contrib-prime-fill-12: #8b5cf6; --contrib-prime-fill-13: #a855f7; --contrib-prime-fill-14: #d946ef; --contrib-prime-fill-15: #ec4899; --contrib-prime-fill-16: #f43f5e; --contrib-prime-fill-17: #ef4444; --contrib-prime-fill-18: #f97316; --contrib-prime-fill-19: #f59e0b; --contrib-prime-fill-20: #eab308;
    --unit-week-fill-1: #f7fee7; --unit-week-fill-2: #ecfccb; --unit-week-fill-3: #d9f99d; --unit-week-fill-4: #bef264; --unit-week-fill-5: #a3e635; --unit-week-fill-6: #84cc16; --unit-week-fill-7: #65a30d; --unit-week-fill-8: #4d7c0f; --unit-week-fill-9: #3f6212; --unit-week-fill-10: #365314; --unit-week-fill-11: #1a2e05; --unit-week-fill-12: #1a2e05; --unit-week-fill-13: #1a2e05; --unit-week-fill-14: #1a2e05; --unit-week-fill-15: #1a2e05;
    --unit-month-fill-1: #ecfdf5; --unit-month-fill-2: #d1fae5; --unit-month-fill-3: #a7f3d0; --unit-month-fill-4: #6ee7b7; --unit-month-fill-5: #34d399; --unit-month-fill-6: #10b981; --unit-month-fill-7: #059669; --unit-month-fill-8: #047857; --unit-month-fill-9: #065f46; --unit-month-fill-10: #064e3b; --unit-month-fill-11: #022c22; --unit-month-fill-12: #022c22; --unit-month-fill-13: #022c22; --unit-month-fill-14: #022c22; --unit-month-fill-15: #022c22;
    --unit-hour-fill-1: #fdf2f8; --unit-hour-fill-2: #fce7f3; --unit-hour-fill-3: #fbcfe8; --unit-hour-fill-4: #f9a8d4; --unit-hour-fill-5: #f472b6; --unit-hour-fill-6: #ec4899; --unit-hour-fill-7: #db2777; --unit-hour-fill-8: #be185d; --unit-hour-fill-9: #9d174d; --unit-hour-fill-10: #831843; --unit-hour-fill-11: #500724; --unit-hour-fill-12: #500724; --unit-hour-fill-13: #500724; --unit-hour-fill-14: #500724; --unit-hour-fill-15: #500724;
    --unit-primeYear-fill-1: #f5f3ff; --unit-primeYear-fill-2: #ede9fe; --unit-primeYear-fill-3: #ddd6fe; --unit-primeYear-fill-4: #c4b5fd; --unit-primeYear-fill-5: #a78bfa; --unit-primeYear-fill-6: #8b5cf6; --unit-primeYear-fill-7: #7c3aed; --unit-primeYear-fill-8: #6d28d9; --unit-primeYear-fill-9: #5b21b6; --unit-primeYear-fill-10: #4c1d95; --unit-primeYear-fill-11: #2e1065; --unit-primeYear-fill-12: #2e1065; --unit-primeYear-fill-13: #2e1065; --unit-primeYear-fill-14: #2e1065; --unit-primeYear-fill-15: #2e1065;
    --unit-awakeSlot-fill-1: #eff6ff; --unit-awakeSlot-fill-2: #dbeafe; --unit-awakeSlot-fill-3: #bfdbfe; --unit-awakeSlot-fill-4: #93c5fd; --unit-awakeSlot-fill-5: #60a5fa; --unit-awakeSlot-fill-6: #3b82f6; --unit-awakeSlot-fill-7: #2563eb; --unit-awakeSlot-fill-8: #1d4ed8; --unit-awakeSlot-fill-9: #1e40af; --unit-awakeSlot-fill-10: #1e3a8a; --unit-awakeSlot-fill-11: #172554; --unit-awakeSlot-fill-12: #172554; --unit-awakeSlot-fill-13: #172554; --unit-awakeSlot-fill-14: #172554; --unit-awakeSlot-fill-15: #172554;
    --unit-daySlot-fill-1: #f0fdfa; --unit-daySlot-fill-2: #ccfbf1; --unit-daySlot-fill-3: #99f6e4; --unit-daySlot-fill-4: #5eead4; --unit-daySlot-fill-5: #2dd4bf; --unit-daySlot-fill-6: #14b8a6; --unit-daySlot-fill-7: #0d9488; --unit-daySlot-fill-8: #0f766e; --unit-daySlot-fill-9: #115e59; --unit-daySlot-fill-10: #134e4a; --unit-daySlot-fill-11: #042f2e; --unit-daySlot-fill-12: #042f2e; --unit-daySlot-fill-13: #042f2e; --unit-daySlot-fill-14: #042f2e; --unit-daySlot-fill-15: #042f2e;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(6, 182, 212, 0.1); /* Optional: Adjust dot color */
    font-family: 'Fredoka One', cursive; /* Apply fun font */
}
/* Reset font for specific elements in kids mode */
body.kids-rainbow-mode .contrib-grid-label,
body.kids-rainbow-mode .progress-percent-text,
body.kids-rainbow-mode input,
body.kids-rainbow-mode label,
body.kids-rainbow-mode p,
body.kids-rainbow-mode .birthdate-status,
body.kids-rainbow-mode #slotCountdown,
body.kids-rainbow-mode .tile .label {
    font-family: 'Inter', sans-serif;
}

/* --- Kids Variant 2: Kids Space --- */
body.kids-space-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #0f172a; --text-color: #e2e8f0; --text-muted-color: #94a3b8; --heading-color: #fef08a; --link-color: #7dd3fc; --link-hover-color: #e0f2fe; --tile-bg: #1e293b; --tile-border: #475569; --tile-shadow: rgba(0,0,0,0.2); --tile-hover-shadow: rgba(0,0,0,0.3); --tile-label-color: #94a3b8; --tile-value-color: #fef08a; --tile-past-bg: #4b5563; --tile-past-text: #f3f4f6; --tile-past-border: #374151; --tile-current-bg: #7c3aed; --tile-current-text: #ffffff; --tile-current-border: #6d28d9; --tile-upcoming-bg: #451a03; --tile-upcoming-text: #fef3c7; --tile-upcoming-border: #78350f; --tile-future-bg: #1e3a8a; --tile-future-text: #dbeafe; --tile-future-border: #1e40af;
    --progress-text-prime: #fca5a5;
    --contrib-square-bg: #334155; --contrib-square-border: #475569; --contrib-current-border: #7c3aed; --progress-text-lifespan: #a5b4fc; --button-bg: #3b82f6; --button-text: #ffffff; --button-hover-bg: #60a5fa; --button-cancel-bg: #334155; --button-cancel-text: #e2e8f0; --button-cancel-hover-bg: #475569; --input-border: #475569; --input-focus-ring: #7c3aed; --input-text: #e2e8f0; --input-bg: #1e293b; --icon-color: #7dd3fc; --section-bg: #1e293b; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2); --theme-button-bg: #334155; --theme-button-icon-color: #e2e8f0; --theme-button-hover-bg: #475569; --theme-button-active-bg: #6b7280; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #818cf8; --icon-tick-color: #34d399; --icon-cross-color: #f87171; --modal-bg: #1e293b; --modal-overlay-bg: rgba(0, 0, 0, 0.7); --modal-border: #475569; --modal-close-icon-color: #94a3b8; --modal-close-icon-hover-bg: #334155; --settings-icon-color: #94a3b8; --settings-icon-hover-bg: #334155;
    /* --- GRADIENTS (Replace with theme-specific colors - e.g., deep blues, purples, yellows) --- */
    --contrib-lifespan-fill-1: #0c4a6e; --contrib-lifespan-fill-2: #075985; --contrib-lifespan-fill-3: #0369a1; --contrib-lifespan-fill-4: #0284c7; --contrib-lifespan-fill-5: #1e3a8a; --contrib-lifespan-fill-6: #1e40af; --contrib-lifespan-fill-7: #1d4ed8; --contrib-lifespan-fill-8: #312e81; --contrib-lifespan-fill-9: #3730a3; --contrib-lifespan-fill-10: #4338ca; --contrib-lifespan-fill-11: #5b21b6; --contrib-lifespan-fill-12: #6d28d9; --contrib-lifespan-fill-13: #7c3aed; --contrib-lifespan-fill-14: #a21caf; --contrib-lifespan-fill-15: #be185d; --contrib-lifespan-fill-16: #db2777; --contrib-lifespan-fill-17: #be123c; --contrib-lifespan-fill-18: #e11d48; --contrib-lifespan-fill-19: #f43f5e; --contrib-lifespan-fill-20: #fb7185;
    --contrib-prime-fill-1: #713f12; --contrib-prime-fill-2: #854d0e; --contrib-prime-fill-3: #a16207; --contrib-prime-fill-4: #ca8a04; --contrib-prime-fill-5: #eab308; --contrib-prime-fill-6: #7c2d12; --contrib-prime-fill-7: #9a3412; --contrib-prime-fill-8: #b45309; --contrib-prime-fill-9: #d97706; --contrib-prime-fill-10: #ea580c; --contrib-prime-fill-11: #991b1b; --contrib-prime-fill-12: #b91c1c; --contrib-prime-fill-13: #dc2626; --contrib-prime-fill-14: #ef4444; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #fca5a5; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fee2e2; --contrib-prime-fill-19: #ffedd5; --contrib-prime-fill-20: #fef3c7;
    --unit-week-fill-1: #0c4a6e; --unit-week-fill-2: #075985; --unit-week-fill-3: #0369a1; --unit-week-fill-4: #0284c7; --unit-week-fill-5: #0ea5e9; --unit-week-fill-6: #38bdf8; --unit-week-fill-7: #7dd3fc; --unit-week-fill-8: #bae6fd; --unit-week-fill-9: #e0f2fe; --unit-week-fill-10: #f0f9ff; --unit-week-fill-11: #f0f9ff; --unit-week-fill-12: #f0f9ff; --unit-week-fill-13: #f0f9ff; --unit-week-fill-14: #f0f9ff; --unit-week-fill-15: #f0f9ff;
    --unit-month-fill-1: #134e4a; --unit-month-fill-2: #115e59; --unit-month-fill-3: #0f766e; --unit-month-fill-4: #0d9488; --unit-month-fill-5: #14b8a6; --unit-month-fill-6: #2dd4bf; --unit-month-fill-7: #5eead4; --unit-month-fill-8: #99f6e4; --unit-month-fill-9: #ccfbf1; --unit-month-fill-10: #f0fdfa; --unit-month-fill-11: #f0fdfa; --unit-month-fill-12: #f0fdfa; --unit-month-fill-13: #f0fdfa; --unit-month-fill-14: #f0fdfa; --unit-month-fill-15: #f0fdfa;
    --unit-hour-fill-1: #78350f; --unit-hour-fill-2: #92400e; --unit-hour-fill-3: #a16207; --unit-hour-fill-4: #b45309; --unit-hour-fill-5: #ca8a04; --unit-hour-fill-6: #d97706; --unit-hour-fill-7: #eab308; --unit-hour-fill-8: #f59e0b; --unit-hour-fill-9: #facc15; --unit-hour-fill-10: #fbbf24; --unit-hour-fill-11: #fcd34d; --unit-hour-fill-12: #fde68a; --unit-hour-fill-13: #fef3c7; --unit-hour-fill-14: #fef9c3; --unit-hour-fill-15: #fffbeb;
    --unit-primeYear-fill-1: #312e81; --unit-primeYear-fill-2: #3730a3; --unit-primeYear-fill-3: #4338ca; --unit-primeYear-fill-4: #4f46e5; --unit-primeYear-fill-5: #6366f1; --unit-primeYear-fill-6: #818cf8; --unit-primeYear-fill-7: #a5b4fc; --unit-primeYear-fill-8: #c7d2fe; --unit-primeYear-fill-9: #e0e7ff; --unit-primeYear-fill-10: #eef2ff; --unit-primeYear-fill-11: #eef2ff; --unit-primeYear-fill-12: #eef2ff; --unit-primeYear-fill-13: #eef2ff; --unit-primeYear-fill-14: #eef2ff; --unit-primeYear-fill-15: #eef2ff;
    --unit-awakeSlot-fill-1: #064e3b; --unit-awakeSlot-fill-2: #065f46; --unit-awakeSlot-fill-3: #047857; --unit-awakeSlot-fill-4: #059669; --unit-awakeSlot-fill-5: #10b981; --unit-awakeSlot-fill-6: #34d399; --unit-awakeSlot-fill-7: #6ee7b7; --unit-awakeSlot-fill-8: #a7f3d0; --unit-awakeSlot-fill-9: #d1fae5; --unit-awakeSlot-fill-10: #ecfdf5; --unit-awakeSlot-fill-11: #ecfdf5; --unit-awakeSlot-fill-12: #ecfdf5; --unit-awakeSlot-fill-13: #ecfdf5; --unit-awakeSlot-fill-14: #ecfdf5; --unit-awakeSlot-fill-15: #ecfdf5;
    --unit-daySlot-fill-1: #3730a3; --unit-daySlot-fill-2: #4338ca; --unit-daySlot-fill-3: #4f46e5; --unit-daySlot-fill-4: #6366f1; --unit-daySlot-fill-5: #818cf8; --unit-daySlot-fill-6: #a5b4fc; --unit-daySlot-fill-7: #c7d2fe; --unit-daySlot-fill-8: #e0e7ff; --unit-daySlot-fill-9: #eef2ff; --unit-daySlot-fill-10: #eef2ff; --unit-daySlot-fill-11: #eef2ff; --unit-daySlot-fill-12: #eef2ff; --unit-daySlot-fill-13: #eef2ff; --unit-daySlot-fill-14: #eef2ff; --unit-daySlot-fill-15: #eef2ff;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(255, 255, 255, 0.04); /* Optional: Adjust dot color */
     font-family: 'Fredoka One', cursive; /* Apply fun font */
}
 /* Reset font for specific elements in kids mode */
 body.kids-space-mode .contrib-grid-label,
 body.kids-space-mode .progress-percent-text,
 body.kids-space-mode input,
 body.kids-space-mode label,
 body.kids-space-mode p,
 body.kids-space-mode .birthdate-status,
 body.kids-space-mode #slotCountdown,
 body.kids-space-mode .tile .label {
     font-family: 'Inter', sans-serif;
 }

/* --- Twilight Mode 1: Twilight Dusk --- */
body.twilight-dusk-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #2d3748; --text-color: #e2e8f0; --text-muted-color: #a0aec0; --heading-color: #f6ad55; --link-color: #f6ad55; --link-hover-color: #fbd38d; --tile-bg: #4a5568; --tile-border: #718096; --tile-shadow: rgba(0,0,0,0.2); --tile-hover-shadow: rgba(0,0,0,0.3); --tile-label-color: #a0aec0; --tile-value-color: #f6ad55; --tile-past-bg: #4b5563; --tile-past-text: #f3f4f6; --tile-past-border: #374151; --tile-current-bg: #9f7aea; --tile-current-text: #ffffff; --tile-current-border: #805ad5; --tile-upcoming-bg: #451a03; --tile-upcoming-text: #fef3c7; --tile-upcoming-border: #78350f; --tile-future-bg: #1e3a8a; --tile-future-text: #dbeafe; --tile-future-border: #1e40af;
    --progress-text-prime: #fca5a5;
    --contrib-square-bg: #718096; --contrib-square-border: #a0aec0; --contrib-current-border: #9f7aea; --progress-text-lifespan: #a5b4fc; --button-bg: #ed8936; --button-text: #ffffff; --button-hover-bg: #f6ad55; --button-cancel-bg: #718096; --button-cancel-text: #e2e8f0; --button-cancel-hover-bg: #a0aec0; --input-border: #718096; --input-focus-ring: #9f7aea; --input-text: #e2e8f0; --input-bg: #4a5568; --icon-color: #f6ad55; --section-bg: #4a5568; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.2); --theme-button-bg: #718096; --theme-button-icon-color: #e2e8f0; --theme-button-hover-bg: #a0aec0; --theme-button-active-bg: #6b7280; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #818cf8; --icon-tick-color: #34d399; --icon-cross-color: #f87171; --modal-bg: #4a5568; --modal-overlay-bg: rgba(0, 0, 0, 0.7); --modal-border: #718096; --modal-close-icon-color: #a0aec0; --modal-close-icon-hover-bg: #718096; --settings-icon-color: #a0aec0; --settings-icon-hover-bg: #718096;
    /* --- GRADIENTS (Replace with theme-specific colors - e.g., oranges, purples, deep blues) --- */
    --contrib-lifespan-fill-1: #4c1d95; --contrib-lifespan-fill-2: #5b21b6; --contrib-lifespan-fill-3: #6d28d9; --contrib-lifespan-fill-4: #7c3aed; --contrib-lifespan-fill-5: #8b5cf6; --contrib-lifespan-fill-6: #a78bfa; --contrib-lifespan-fill-7: #c4b5fd; --contrib-lifespan-fill-8: #ddd6fe; --contrib-lifespan-fill-9: #e9d5ff; --contrib-lifespan-fill-10: #f3e8ff; --contrib-lifespan-fill-11: #fed7aa; --contrib-lifespan-fill-12: #fdbb74; --contrib-lifespan-fill-13: #fb923c; --contrib-lifespan-fill-14: #f97316; --contrib-lifespan-fill-15: #ea580c; --contrib-lifespan-fill-16: #c2410c; --contrib-lifespan-fill-17: #9a3412; --contrib-lifespan-fill-18: #7c2d12; --contrib-lifespan-fill-19: #451a03; --contrib-lifespan-fill-20: #2d3748;
    --contrib-prime-fill-1: #713f12; --contrib-prime-fill-2: #854d0e; --contrib-prime-fill-3: #a16207; --contrib-prime-fill-4: #ca8a04; --contrib-prime-fill-5: #eab308; --contrib-prime-fill-6: #7c2d12; --contrib-prime-fill-7: #9a3412; --contrib-prime-fill-8: #b45309; --contrib-prime-fill-9: #d97706; --contrib-prime-fill-10: #ea580c; --contrib-prime-fill-11: #991b1b; --contrib-prime-fill-12: #b91c1c; --contrib-prime-fill-13: #dc2626; --contrib-prime-fill-14: #ef4444; --contrib-prime-fill-15: #f87171; --contrib-prime-fill-16: #fca5a5; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fee2e2; --contrib-prime-fill-19: #ffedd5; --contrib-prime-fill-20: #fef3c7;
    --unit-week-fill-1: #0c4a6e; --unit-week-fill-2: #075985; --unit-week-fill-3: #0369a1; --unit-week-fill-4: #0284c7; --unit-week-fill-5: #0ea5e9; --unit-week-fill-6: #38bdf8; --unit-week-fill-7: #7dd3fc; --unit-week-fill-8: #bae6fd; --unit-week-fill-9: #e0f2fe; --unit-week-fill-10: #f0f9ff; --unit-week-fill-11: #f0f9ff; --unit-week-fill-12: #f0f9ff; --unit-week-fill-13: #f0f9ff; --unit-week-fill-14: #f0f9ff; --unit-week-fill-15: #f0f9ff;
    --unit-month-fill-1: #134e4a; --unit-month-fill-2: #115e59; --unit-month-fill-3: #0f766e; --unit-month-fill-4: #0d9488; --unit-month-fill-5: #14b8a6; --unit-month-fill-6: #2dd4bf; --unit-month-fill-7: #5eead4; --unit-month-fill-8: #99f6e4; --unit-month-fill-9: #ccfbf1; --unit-month-fill-10: #f0fdfa; --unit-month-fill-11: #f0fdfa; --unit-month-fill-12: #f0fdfa; --unit-month-fill-13: #f0fdfa; --unit-month-fill-14: #f0fdfa; --unit-month-fill-15: #f0fdfa;
    --unit-hour-fill-1: #78350f; --unit-hour-fill-2: #92400e; --unit-hour-fill-3: #a16207; --unit-hour-fill-4: #b45309; --unit-hour-fill-5: #ca8a04; --unit-hour-fill-6: #d97706; --unit-hour-fill-7: #eab308; --unit-hour-fill-8: #f59e0b; --unit-hour-fill-9: #facc15; --unit-hour-fill-10: #fbbf24; --unit-hour-fill-11: #fcd34d; --unit-hour-fill-12: #fde68a; --unit-hour-fill-13: #fef3c7; --unit-hour-fill-14: #fef9c3; --unit-hour-fill-15: #fffbeb;
    --unit-primeYear-fill-1: #312e81; --unit-primeYear-fill-2: #3730a3; --unit-primeYear-fill-3: #4338ca; --unit-primeYear-fill-4: #4f46e5; --unit-primeYear-fill-5: #6366f1; --unit-primeYear-fill-6: #818cf8; --unit-primeYear-fill-7: #a5b4fc; --unit-primeYear-fill-8: #c7d2fe; --unit-primeYear-fill-9: #e0e7ff; --unit-primeYear-fill-10: #eef2ff; --unit-primeYear-fill-11: #eef2ff; --unit-primeYear-fill-12: #eef2ff; --unit-primeYear-fill-13: #eef2ff; --unit-primeYear-fill-14: #eef2ff; --unit-primeYear-fill-15: #eef2ff;
    --unit-awakeSlot-fill-1: #064e3b; --unit-awakeSlot-fill-2: #065f46; --unit-awakeSlot-fill-3: #047857; --unit-awakeSlot-fill-4: #059669; --unit-awakeSlot-fill-5: #10b981; --unit-awakeSlot-fill-6: #34d399; --unit-awakeSlot-fill-7: #6ee7b7; --unit-awakeSlot-fill-8: #a7f3d0; --unit-awakeSlot-fill-9: #d1fae5; --unit-awakeSlot-fill-10: #ecfdf5; --unit-awakeSlot-fill-11: #ecfdf5; --unit-awakeSlot-fill-12: #ecfdf5; --unit-awakeSlot-fill-13: #ecfdf5; --unit-awakeSlot-fill-14: #ecfdf5; --unit-awakeSlot-fill-15: #ecfdf5;
    --unit-daySlot-fill-1: #3730a3; --unit-daySlot-fill-2: #4338ca; --unit-daySlot-fill-3: #4f46e5; --unit-daySlot-fill-4: #6366f1; --unit-daySlot-fill-5: #818cf8; --unit-daySlot-fill-6: #a5b4fc; --unit-daySlot-fill-7: #c7d2fe; --unit-daySlot-fill-8: #e0e7ff; --unit-daySlot-fill-9: #eef2ff; --unit-daySlot-fill-10: #eef2ff; --unit-daySlot-fill-11: #eef2ff; --unit-daySlot-fill-12: #eef2ff; --unit-daySlot-fill-13: #eef2ff; --unit-daySlot-fill-14: #eef2ff; --unit-daySlot-fill-15: #eef2ff;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(255, 255, 255, 0.04); /* Optional: Adjust dot color */
}

/* --- Twilight Mode 2: Twilight Dawn --- */
body.twilight-dawn-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #fef3c7; --text-color: #422006; --text-muted-color: #7c2d12; --heading-color: #c2410c; --link-color: #f97316; --link-hover-color: #fb923c; --tile-bg: #fffbeb; --tile-border: #fde68a; --tile-shadow: rgba(0,0,0,0.05); --tile-hover-shadow: rgba(0,0,0,0.1); --tile-label-color: #7c2d12; --tile-value-color: #c2410c; --tile-past-bg: #4b5563; --tile-past-text: #ffffff; --tile-past-border: #374151; --tile-current-bg: #f472b6; --tile-current-text: #500724; --tile-current-border: #ec4899; --tile-upcoming-bg: #fef9c3; --tile-upcoming-text: #a16207; --tile-upcoming-border: #fde047; --tile-future-bg: #e0f2fe; --tile-future-text: #075985; --tile-future-border: #bae6fd;
    --progress-text-prime: #9a3412;
    --contrib-square-bg: #fde68a; --contrib-square-border: #fcd34d; --contrib-current-border: #f472b6; --progress-text-lifespan: #be185d; --button-bg: #f97316; --button-text: #ffffff; --button-hover-bg: #fb923c; --button-cancel-bg: #fde68a; --button-cancel-text: #7c2d12; --button-cancel-hover-bg: #fcd34d; --input-border: #fde68a; --input-focus-ring: #f472b6; --input-text: #422006; --input-bg: #fffbeb; --icon-color: #f97316; --section-bg: #fffbeb; --section-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1); --theme-button-bg: #fde68a; --theme-button-icon-color: #7c2d12; --theme-button-hover-bg: #fcd34d; --theme-button-active-bg: #fbbf24; --theme-button-active-icon-color: #422006; --theme-button-active-outline: #f472b6; --icon-tick-color: #10b981; --icon-cross-color: #ef4444; --modal-bg: #fffbeb; --modal-overlay-bg: rgba(0, 0, 0, 0.5); --modal-border: #fde68a; --modal-close-icon-color: #7c2d12; --modal-close-icon-hover-bg: #fde68a; --settings-icon-color: #7c2d12; --settings-icon-hover-bg: #fde68a;
    /* --- GRADIENTS (Replace with theme-specific colors - e.g., yellows, oranges, pinks) --- */
    --contrib-lifespan-fill-1: #e0f2fe; --contrib-lifespan-fill-2: #bfdbfe; --contrib-lifespan-fill-3: #93c5fd; --contrib-lifespan-fill-4: #60a5fa; --contrib-lifespan-fill-5: #c7d2fe; --contrib-lifespan-fill-6: #a5b4fc; --contrib-lifespan-fill-7: #818cf8; --contrib-lifespan-fill-8: #ddd6fe; --contrib-lifespan-fill-9: #c4b5fd; --contrib-lifespan-fill-10: #a78bfa; --contrib-lifespan-fill-11: #f5d0fe; --contrib-lifespan-fill-12: #f0abfc; --contrib-lifespan-fill-13: #e879f9; --contrib-lifespan-fill-14: #fbcfe8; --contrib-lifespan-fill-15: #f9a8d4; --contrib-lifespan-fill-16: #f472b6; --contrib-lifespan-fill-17: #fed7aa; --contrib-lifespan-fill-18: #fdbb74; --contrib-lifespan-fill-19: #fb923c; --contrib-lifespan-fill-20: #f87171;
    --contrib-prime-fill-1: #fef9c3; --contrib-prime-fill-2: #fef3c7; --contrib-prime-fill-3: #fde68a; --contrib-prime-fill-4: #fde047; --contrib-prime-fill-5: #facc15; --contrib-prime-fill-6: #fef3c7; --contrib-prime-fill-7: #fde68a; --contrib-prime-fill-8: #fcd34d; --contrib-prime-fill-9: #fbbf24; --contrib-prime-fill-10: #f59e0b; --contrib-prime-fill-11: #ffedd5; --contrib-prime-fill-12: #fed7aa; --contrib-prime-fill-13: #fdbb74; --contrib-prime-fill-14: #fb923c; --contrib-prime-fill-15: #f97316; --contrib-prime-fill-16: #fee2e2; --contrib-prime-fill-17: #fecaca; --contrib-prime-fill-18: #fca5a5; --contrib-prime-fill-19: #f87171; --contrib-prime-fill-20: #ef4444;
    --unit-week-fill-1: #ecfeff; --unit-week-fill-2: #cffafe; --unit-week-fill-3: #a5f3fc; --unit-week-fill-4: #67e8f9; --unit-week-fill-5: #22d3ee; --unit-week-fill-6: #06b6d4; --unit-week-fill-7: #0891b2; --unit-week-fill-8: #0e7490; --unit-week-fill-9: #155e75; --unit-week-fill-10: #164e63; --unit-week-fill-11: #083344; --unit-week-fill-12: #083344; --unit-week-fill-13: #083344; --unit-week-fill-14: #083344; --unit-week-fill-15: #083344;
    --unit-month-fill-1: #f0fdf4; --unit-month-fill-2: #dcfce7; --unit-month-fill-3: #bbf7d0; --unit-month-fill-4: #86efac; --unit-month-fill-5: #4ade80; --unit-month-fill-6: #22c55e; --unit-month-fill-7: #16a34a; --unit-month-fill-8: #15803d; --unit-month-fill-9: #166534; --unit-month-fill-10: #14532d; --unit-month-fill-11: #052e16; --unit-month-fill-12: #052e16; --unit-month-fill-13: #052e16; --unit-month-fill-14: #052e16; --unit-month-fill-15: #052e16;
    --unit-hour-fill-1: #fff7ed; --unit-hour-fill-2: #ffedd5; --unit-hour-fill-3: #fed7aa; --unit-hour-fill-4: #fdbb74; --unit-hour-fill-5: #fb923c; --unit-hour-fill-6: #f97316; --unit-hour-fill-7: #ea580c; --unit-hour-fill-8: #c2410c; --unit-hour-fill-9: #9a3412; --unit-hour-fill-10: #7c2d12; --unit-hour-fill-11: #451a03; --unit-hour-fill-12: #451a03; --unit-hour-fill-13: #451a03; --unit-hour-fill-14: #451a03; --unit-hour-fill-15: #451a03;
    --unit-primeYear-fill-1: #f5f3ff; --unit-primeYear-fill-2: #ede9fe; --unit-primeYear-fill-3: #ddd6fe; --unit-primeYear-fill-4: #c4b5fd; --unit-primeYear-fill-5: #a78bfa; --unit-primeYear-fill-6: #8b5cf6; --unit-primeYear-fill-7: #7c3aed; --unit-primeYear-fill-8: #6d28d9; --unit-primeYear-fill-9: #5b21b6; --unit-primeYear-fill-10: #4c1d95; --unit-primeYear-fill-11: #2e1065; --unit-primeYear-fill-12: #2e1065; --unit-primeYear-fill-13: #2e1065; --unit-primeYear-fill-14: #2e1065; --unit-primeYear-fill-15: #2e1065;
    --unit-awakeSlot-fill-1: #f0fdf4; --unit-awakeSlot-fill-2: #dcfce7; --unit-awakeSlot-fill-3: #bbf7d0; --unit-awakeSlot-fill-4: #86efac; --unit-awakeSlot-fill-5: #4ade80; --unit-awakeSlot-fill-6: #22c55e; --unit-awakeSlot-fill-7: #16a34a; --unit-awakeSlot-fill-8: #15803d; --unit-awakeSlot-fill-9: #166534; --unit-awakeSlot-fill-10: #14532d; --unit-awakeSlot-fill-11: #052e16; --unit-awakeSlot-fill-12: #052e16; --unit-awakeSlot-fill-13: #052e16; --unit-awakeSlot-fill-14: #052e16; --unit-awakeSlot-fill-15: #052e16;
    --unit-daySlot-fill-1: #f5f3ff; --unit-daySlot-fill-2: #ede9fe; --unit-daySlot-fill-3: #ddd6fe; --unit-daySlot-fill-4: #c4b5fd; --unit-daySlot-fill-5: #a78bfa; --unit-daySlot-fill-6: #8b5cf6; --unit-daySlot-fill-7: #7c3aed; --unit-daySlot-fill-8: #6d28d9; --unit-daySlot-fill-9: #5b21b6; --unit-daySlot-fill-10: #4c1d95; --unit-daySlot-fill-11: #3730a3; --unit-daySlot-fill-12: #312e81; --unit-daySlot-fill-13: #2e1065; --unit-daySlot-fill-14: #2e1065; --unit-daySlot-fill-15: #2e1065;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(124, 45, 18, 0.1); /* Optional: Adjust dot color */
}

/* --- Cyberpunk Variant: Cyberpunk Neon --- */
body.cyberpunk-neon-mode {
    /* --- !!! REPLACE ALL COLORS BELOW FOR THIS THEME !!! --- */
    --bg-color: #1a1a1a; --text-color: #00ff00; --text-muted-color: #a0a0a0; --heading-color: #ff00ff; --link-color: #00f0ff; --link-hover-color: #ffffff; --tile-bg: rgba(30, 30, 30, 0.8); --tile-border: #00ff00; --tile-shadow: 0 0 10px rgba(0, 255, 0, 0.5); --tile-hover-shadow: 0 0 15px rgba(0, 240, 255, 0.6); --tile-label-color: #a0a0a0; --tile-value-color: #ffff00; --tile-past-bg: #3d0f57; --tile-past-text: #a0a0c0; --tile-past-border: #5a189a; --tile-current-bg: #00f0ff; --tile-current-text: #0d0221; --tile-current-border: #ffffff; --tile-upcoming-bg: #5f0f40; --tile-upcoming-text: #ff80ff; --tile-upcoming-border: #9a031e; --tile-future-bg: #023047; --tile-future-text: #8ecae6; --tile-future-border: #219ebc;
    --progress-text-prime: #f4ff00;
    --contrib-square-bg: #1a1a3a; --contrib-square-border: #3a3a5a; --contrib-current-border: #00f0ff; --progress-text-lifespan: #00ff80; --button-bg: #ff00ff; --button-text: #ffffff; --button-hover-bg: #ff40ff; --button-cancel-bg: #4a4a6a; --button-cancel-text: #c0c0e0; --button-cancel-hover-bg: #6a6a8a; --input-border: #ff00ff; --input-focus-ring: #00f0ff; --input-text: #f0f0f0; --input-bg: #1a1a3a; --icon-color: #00f0ff; --section-bg: rgba(10, 10, 30, 0.7); --section-shadow: 0 0 15px rgba(0, 240, 255, 0.3); --theme-button-bg: #3a3a5a; --theme-button-icon-color: #c0c0e0; --theme-button-hover-bg: #4a4a6a; --theme-button-active-bg: #ff00ff; --theme-button-active-icon-color: #ffffff; --theme-button-active-outline: #00f0ff; --icon-tick-color: #00ff80; --icon-cross-color: #ff4040; --modal-bg: #0d0221; --modal-overlay-bg: rgba(0, 0, 20, 0.85); --modal-border: #ff00ff; --modal-close-icon-color: #a0a0c0; --modal-close-icon-hover-bg: #3a3a5a; --settings-icon-color: #a0a0c0; --settings-icon-hover-bg: #3a3a5a;
    /* --- GRADIENTS (Use neon greens, yellows, cyans, magentas) --- */
    --contrib-lifespan-fill-1: #003f5c; --contrib-lifespan-fill-2: #005f8c; --contrib-lifespan-fill-3: #007fbc; --contrib-lifespan-fill-4: #00a0ec; --contrib-lifespan-fill-5: #00c0ff; --contrib-lifespan-fill-6: #2a00ff; --contrib-lifespan-fill-7: #4a20ff; --contrib-lifespan-fill-8: #6a40ff; --contrib-lifespan-fill-9: #8a60ff; --contrib-lifespan-fill-10: #aa80ff; --contrib-lifespan-fill-11: #5a189a; --contrib-lifespan-fill-12: #7b2cbf; --contrib-lifespan-fill-13: #9d4edd; --contrib-lifespan-fill-14: #c77dff; --contrib-lifespan-fill-15: #e0aaff; --contrib-lifespan-fill-16: #ff00ff; --contrib-lifespan-fill-17: #ff40ff; --contrib-lifespan-fill-18: #ff80ff; --contrib-lifespan-fill-19: #ffbfff; --contrib-lifespan-fill-20: #ffffff;
    --contrib-prime-fill-1: #ffbf00; --contrib-prime-fill-2: #ffd000; --contrib-prime-fill-3: #ffe000; --contrib-prime-fill-4: #fff000; --contrib-prime-fill-5: #ffff00; --contrib-prime-fill-6: #dfff00; --contrib-prime-fill-7: #bfff00; --contrib-prime-fill-8: #9fff00; --contrib-prime-fill-9: #80ff00; --contrib-prime-fill-10: #60ff00; --contrib-prime-fill-11: #40ff00; --contrib-prime-fill-12: #20ff00; --contrib-prime-fill-13: #00ff00; --contrib-prime-fill-14: #00ff40; --contrib-prime-fill-15: #00ff80; --contrib-prime-fill-16: #00ffbf; --contrib-prime-fill-17: #00ffff; --contrib-prime-fill-18: #40ffff; --contrib-prime-fill-19: #80ffff; --contrib-prime-fill-20: #bffff;
    --unit-week-fill-1: #003049; --unit-week-fill-2: #004c73; --unit-week-fill-3: #00679d; --unit-week-fill-4: #0083c7; --unit-week-fill-5: #009ef1; --unit-week-fill-6: #00baff; --unit-week-fill-7: #40c7ff; --unit-week-fill-8: #60d4ff; --unit-week-fill-9: #80e1ff; --unit-week-fill-10: #a0eeff; --unit-week-fill-11: #b0f4ff; --unit-week-fill-12: #c0faff; --unit-week-fill-13: #d0fcff; --unit-week-fill-14: #e0feff; --unit-week-fill-15: #f0ffff;
    --unit-month-fill-1: #004b23; --unit-month-fill-2: #006430; --unit-month-fill-3: #007f3d; --unit-month-fill-4: #009a4a; --unit-month-fill-5: #00b557; --unit-month-fill-6: #00d064; --unit-month-fill-7: #00eb71; --unit-month-fill-8: #00ff80; --unit-month-fill-9: #30ff90; --unit-month-fill-10: #60ffa0; --unit-month-fill-11: #80ffb0; --unit-month-fill-12: #a0ffc0; --unit-month-fill-13: #b0ffd0; --unit-month-fill-14: #c0ffe0; --unit-month-fill-15: #d0fff0;
    --unit-hour-fill-1: #7a0177; --unit-hour-fill-2: #9c118b; --unit-hour-fill-3: #be219f; --unit-hour-fill-4: #e031b3; --unit-hour-fill-5: #f746c1; --unit-hour-fill-6: #ff5bcd; --unit-hour-fill-7: #ff70d9; --unit-hour-fill-8: #ff85e5; --unit-hour-fill-9: #ff9af1; --unit-hour-fill-10: #ffaffd; --unit-hour-fill-11: #ffc4ff; --unit-hour-fill-12: #ffd9ff; --unit-hour-fill-13: #ffeaff; --unit-hour-fill-14: #fff5ff; --unit-hour-fill-15: #ffffff;
    --unit-primeYear-fill-1: #ffaa00; --unit-primeYear-fill-2: #ffb800; --unit-primeYear-fill-3: #ffc600; --unit-primeYear-fill-4: #ffd400; --unit-primeYear-fill-5: #ffe200; --unit-primeYear-fill-6: #fff000; --unit-primeYear-fill-7: #ffff30; --unit-primeYear-fill-8: #ffff60; --unit-primeYear-fill-9: #ffff80; --unit-primeYear-fill-10: #ffffa0; --unit-primeYear-fill-11: #ffffb0; --unit-primeYear-fill-12: #ffffc0; --unit-primeYear-fill-13: #ffffd0; --unit-primeYear-fill-14: #ffffe0; --unit-primeYear-fill-15: #fffff0;
    --unit-awakeSlot-fill-1: #008080; --unit-awakeSlot-fill-2: #009a9a; --unit-awakeSlot-fill-3: #00b4b4; --unit-awakeSlot-fill-4: #00cece; --unit-awakeSlot-fill-5: #00e8e8; --unit-awakeSlot-fill-6: #00ffff; --unit-awakeSlot-fill-7: #30ffff; --unit-awakeSlot-fill-8: #60ffff; --unit-awakeSlot-fill-9: #80ffff; --unit-awakeSlot-fill-10: #a0ffff; --unit-awakeSlot-fill-11: #b0ffff; --unit-awakeSlot-fill-12: #c0ffff; --unit-awakeSlot-fill-13: #d0ffff; --unit-awakeSlot-fill-14: #e0ffff; --unit-awakeSlot-fill-15: #f0ffff;
    --unit-daySlot-fill-1: #3a0ca3; --unit-daySlot-fill-2: #4a1fa7; --unit-daySlot-fill-3: #5a32ab; --unit-daySlot-fill-4: #6a45af; --unit-daySlot-fill-5: #7a58b3; --unit-daySlot-fill-6: #8a6bb7; --unit-daySlot-fill-7: #9a7ebb; --unit-daySlot-fill-8: #aa91bf; --unit-daySlot-fill-9: #baa4c3; --unit-daySlot-fill-10: #cab7c7; --unit-daySlot-fill-11: #dacacb; --unit-daySlot-fill-12: #eadcdf; --unit-daySlot-fill-13: #faeef3; --unit-daySlot-fill-14: #fbf5f7; --unit-daySlot-fill-15: #ffffff;
    --unit-current-bg: var(--tile-current-bg);
    --unit-current-border: var(--tile-current-border);
    --dot-color: rgba(255, 0, 255, 0.1); /* Optional: Adjust dot color */
}

        /* --- Base Styles using Variables --- */
        body {
            font-family: 'Inter', sans-serif; /* Default font */
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease, background-image 0.3s ease;
        }

        /* Apply Fredoka One font in colorful mode */
        body.colorful-mode h1,
        body.colorful-mode h2,
        body.colorful-mode h3,
        body.colorful-mode .tile .value, /* Apply to value spans in tiles */
        body.colorful-mode button:not(.theme-button),
        body.colorful-mode #settingsModal h2 /* Apply to modal title */
        {
            font-family: 'Fredoka One', cursive; /* Changed font */
            letter-spacing: 0.02em;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
         body.colorful-mode .tile .label,
         body.colorful-mode p,
         body.colorful-mode span:not(.value):not(.progress-percent-text), /* Exclude value and percentage spans */
         body.colorful-mode input,
         body.colorful-mode .birthdate-status,
         body.colorful-mode label /* Apply to settings labels */
         {
             font-family: 'Inter', sans-serif;
             letter-spacing: normal;
             user-select: text;
             -webkit-user-select: text;
             -moz-user-select: text;
             -ms-user-select: text;
         }
         /* Keep percentage text in Inter */
         .progress-percent-text {
             font-family: 'Inter', sans-serif;
             letter-spacing: normal;
             user-select: text;
             -webkit-user-select: text;
             -moz-user-select: text;
             -ms-user-select: text;
         }
         /* Specific style for the slot countdown value */
         #slotCountdown {
             font-family: 'Inter', sans-serif; /* Ensure countdown uses Inter */
             letter-spacing: normal;
         }


        h1 {
            color: var(--heading-color);
        }

        h2 {
            color: var(--heading-color);
            @apply text-xl font-semibold;
        }
        /* Style for the time-left group labels */
        h3.time-group-label {
             color: var(--text-muted-color);
             @apply text-center text-sm font-semibold mb-2 tracking-wide uppercase;
             min-height: 1.25rem; /* Prevent layout shift when text changes */
        }


        /* --- Theme Switcher Styles --- */
        .theme-switcher {
            @apply flex justify-center gap-2 mb-6;
        }
        .theme-button {
            @apply p-2 rounded-md border border-transparent flex items-center justify-center;
            background-color: var(--theme-button-bg);
            border-color: var(--tile-border);
            transition: background-color 0.2s ease, transform 0.2s ease, outline 0.2s ease;
            outline: 2px solid transparent;
            outline-offset: 2px;
        }
        .theme-button:hover {
            background-color: var(--theme-button-hover-bg);
            transform: translateY(-2px);
        }
        .theme-button.active {
            background-color: var(--theme-button-active-bg);
            outline-color: var(--theme-button-active-outline);
            transform: scale(1.05);
        }
        .theme-icon {
             width: 1.25rem;
             height: 1.25rem;
             stroke: var(--theme-button-icon-color);
             fill: none;
             transition: stroke 0.2s ease, fill 0.2s ease;
        }
         .theme-button.active .theme-icon {
             stroke: var(--theme-button-active-icon-color);
         }
         /* Specific fills/strokes for certain icons */
         #themeBtnDark .theme-icon { /* Dark mode moon */
             fill: var(--theme-button-icon-color);
             stroke: none;
         }
         #themeBtnDark.active .theme-icon {
             fill: var(--theme-button-active-icon-color);
             stroke: none;
         }
         #themeBtnCyberpunk .theme-icon { /* Cyberpunk lightning */
             stroke-width: 1.5; /* Ensure stroke width is set */
         }
         #themeBtnCyberpunk.active .theme-icon {
             stroke: var(--theme-button-active-icon-color);
         }


        /* --- Tile Styles using Variables --- */
        .tile {
         border-radius: 8px;
         text-align: center;
         display: flex;
         flex-direction: column;
         justify-content: center;
         align-items: center;
         box-shadow: 0 1px 3px var(--tile-shadow);
         padding: 0.75rem;
         transition: all 0.2s ease-in-out;
         cursor: default;
         min-height: 90px; /* Ensure consistent height for info tiles */
         border: 1px solid var(--tile-border);
         background-color: var(--tile-bg);
         position: relative;
         overflow: hidden;
        }
        .tile.clickable:hover {
         transform: scale(1.03);
         box-shadow: 0 3px 6px var(--tile-hover-shadow);
         cursor: pointer;
        }
        /* Removed lifespan-tile specific styles */

        /* --- Info Tile & Progress Tile Content Styles using Variables --- */
        .tile .label { font-size: 0.75rem; color: var(--tile-label-color); margin-bottom: 4px; line-height: 1.2; white-space: nowrap; }
        .tile .value { font-size: 1.25rem; font-weight: 700; color: var(--tile-value-color); line-height: 1.2; }

        /* --- GitHub Style Contribution Grid Styles (Updated) --- */
        .contrib-grid-wrapper { /* New wrapper for label+grid */
            display: flex;
            flex-direction: column;
            margin-bottom: 1rem; /* Add margin between grid wrappers */
        }
        .contrib-grid-header { /* New header for label+percentage OR label+count */
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.25rem; /* mb-1 */
        }
        .contrib-grid-label { /* Style for the label */
             font-size: 0.875rem; /* text-sm */
             font-weight: 500; /* font-medium */
             color: var(--text-color);
        }
        .progress-percent-text { /* Style for the percentage or count */
             font-size: 0.875rem; /* text-sm */
             font-weight: 600; /* font-semibold */
             color: var(--text-muted-color); /* Default count color */
        }
         /* Apply specific text colors for each progress bar percentage */
         #lifespanPercentText, #lifespanYearPercentText { color: var(--progress-text-lifespan); } /* Apply lifespan color to both */
         #primePercentText { color: var(--progress-text-prime); }

        .contrib-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(12px, 1fr)); /* Slightly larger squares */
            gap: 2px; /* Keep smaller gap */
            padding: 4px; /* Adjust padding */
            border-radius: 4px;
            background-color: var(--tile-bg);
            border: 1px solid var(--tile-border);
            /* Removed max-height and overflow-y to show all squares */
            box-shadow: var(--section-shadow);
        }
         /* Specific max-height for unit grids (kept for smaller grids) */
         .unit-grid {
             max-height: 80px;
             overflow-y: auto; /* Keep scroll for unit grids if needed */
         }
         /* Specific style for the full day slot grid */
         #daySlotsContribGrid {
             max-height: 40px; /* Allow full day grid to show all slots */
             overflow-y: visible;
             overflow-x: hidden
             border: none;
             background-color: transparent;
             padding: 0;
             box-shadow: none;
         }

        .contrib-square {
            width: 12px; /* Slightly larger squares */
            height: 12px; /* Slightly larger squares */
            border-radius: 2px;
            background-color: var(--contrib-square-bg);
            border: 1px solid var(--contrib-square-border);
            transition: background-color 0.2s ease, outline 0.2s ease, border-color 0.2s ease; /* Added border-color transition */
            position: relative; /* Needed for outline offset */
        }
        /* Gradient Fill square styles - Lifespan (20 Levels) */
        .contrib-square.lifespan-fill-level-1 { background-color: var(--contrib-lifespan-fill-1); border-color: var(--contrib-lifespan-fill-1);}
        .contrib-square.lifespan-fill-level-2 { background-color: var(--contrib-lifespan-fill-2); border-color: var(--contrib-lifespan-fill-2);}
        .contrib-square.lifespan-fill-level-3 { background-color: var(--contrib-lifespan-fill-3); border-color: var(--contrib-lifespan-fill-3);}
        .contrib-square.lifespan-fill-level-4 { background-color: var(--contrib-lifespan-fill-4); border-color: var(--contrib-lifespan-fill-4);}
        .contrib-square.lifespan-fill-level-5 { background-color: var(--contrib-lifespan-fill-5); border-color: var(--contrib-lifespan-fill-5);}
        .contrib-square.lifespan-fill-level-6 { background-color: var(--contrib-lifespan-fill-6); border-color: var(--contrib-lifespan-fill-6);}
        .contrib-square.lifespan-fill-level-7 { background-color: var(--contrib-lifespan-fill-7); border-color: var(--contrib-lifespan-fill-7);}
        .contrib-square.lifespan-fill-level-8 { background-color: var(--contrib-lifespan-fill-8); border-color: var(--contrib-lifespan-fill-8);}
        .contrib-square.lifespan-fill-level-9 { background-color: var(--contrib-lifespan-fill-9); border-color: var(--contrib-lifespan-fill-9);}
        .contrib-square.lifespan-fill-level-10 { background-color: var(--contrib-lifespan-fill-10); border-color: var(--contrib-lifespan-fill-10);}
        .contrib-square.lifespan-fill-level-11 { background-color: var(--contrib-lifespan-fill-11); border-color: var(--contrib-lifespan-fill-11);}
        .contrib-square.lifespan-fill-level-12 { background-color: var(--contrib-lifespan-fill-12); border-color: var(--contrib-lifespan-fill-12);}
        .contrib-square.lifespan-fill-level-13 { background-color: var(--contrib-lifespan-fill-13); border-color: var(--contrib-lifespan-fill-13);}
        .contrib-square.lifespan-fill-level-14 { background-color: var(--contrib-lifespan-fill-14); border-color: var(--contrib-lifespan-fill-14);}
        .contrib-square.lifespan-fill-level-15 { background-color: var(--contrib-lifespan-fill-15); border-color: var(--contrib-lifespan-fill-15);}
        .contrib-square.lifespan-fill-level-16 { background-color: var(--contrib-lifespan-fill-16); border-color: var(--contrib-lifespan-fill-16);}
        .contrib-square.lifespan-fill-level-17 { background-color: var(--contrib-lifespan-fill-17); border-color: var(--contrib-lifespan-fill-17);}
        .contrib-square.lifespan-fill-level-18 { background-color: var(--contrib-lifespan-fill-18); border-color: var(--contrib-lifespan-fill-18);}
        .contrib-square.lifespan-fill-level-19 { background-color: var(--contrib-lifespan-fill-19); border-color: var(--contrib-lifespan-fill-19);}
        .contrib-square.lifespan-fill-level-20 { background-color: var(--contrib-lifespan-fill-20); border-color: var(--contrib-lifespan-fill-20);}

        /* Gradient Fill square styles - Prime (20 Levels) */
        .contrib-square.prime-fill-level-1 { background-color: var(--contrib-prime-fill-1); border-color: var(--contrib-prime-fill-1);}
        .contrib-square.prime-fill-level-2 { background-color: var(--contrib-prime-fill-2); border-color: var(--contrib-prime-fill-2);}
        .contrib-square.prime-fill-level-3 { background-color: var(--contrib-prime-fill-3); border-color: var(--contrib-prime-fill-3);}
        .contrib-square.prime-fill-level-4 { background-color: var(--contrib-prime-fill-4); border-color: var(--contrib-prime-fill-4);}
        .contrib-square.prime-fill-level-5 { background-color: var(--contrib-prime-fill-5); border-color: var(--contrib-prime-fill-5);}
        .contrib-square.prime-fill-level-6 { background-color: var(--contrib-prime-fill-6); border-color: var(--contrib-prime-fill-6);}
        .contrib-square.prime-fill-level-7 { background-color: var(--contrib-prime-fill-7); border-color: var(--contrib-prime-fill-7);}
        .contrib-square.prime-fill-level-8 { background-color: var(--contrib-prime-fill-8); border-color: var(--contrib-prime-fill-8);}
        .contrib-square.prime-fill-level-9 { background-color: var(--contrib-prime-fill-9); border-color: var(--contrib-prime-fill-9);}
        .contrib-square.prime-fill-level-10 { background-color: var(--contrib-prime-fill-10); border-color: var(--contrib-prime-fill-10);}
        .contrib-square.prime-fill-level-11 { background-color: var(--contrib-prime-fill-11); border-color: var(--contrib-prime-fill-11);}
        .contrib-square.prime-fill-level-12 { background-color: var(--contrib-prime-fill-12); border-color: var(--contrib-prime-fill-12);}
        .contrib-square.prime-fill-level-13 { background-color: var(--contrib-prime-fill-13); border-color: var(--contrib-prime-fill-13);}
        .contrib-square.prime-fill-level-14 { background-color: var(--contrib-prime-fill-14); border-color: var(--contrib-prime-fill-14);}
        .contrib-square.prime-fill-level-15 { background-color: var(--contrib-prime-fill-15); border-color: var(--contrib-prime-fill-15);}
        .contrib-square.prime-fill-level-16 { background-color: var(--contrib-prime-fill-16); border-color: var(--contrib-prime-fill-16);}
        .contrib-square.prime-fill-level-17 { background-color: var(--contrib-prime-fill-17); border-color: var(--contrib-prime-fill-17);}
        .contrib-square.prime-fill-level-18 { background-color: var(--contrib-prime-fill-18); border-color: var(--contrib-prime-fill-18);}
        .contrib-square.prime-fill-level-19 { background-color: var(--contrib-prime-fill-19); border-color: var(--contrib-prime-fill-19);}
        .contrib-square.prime-fill-level-20 { background-color: var(--contrib-prime-fill-20); border-color: var(--contrib-prime-fill-20);}

        /* Unit Grid Gradient Fill Styles (Weeks - 15 Levels) */
        .contrib-square.unit-week-fill-1 { background-color: var(--unit-week-fill-1); border-color: var(--unit-week-fill-1); }
        .contrib-square.unit-week-fill-2 { background-color: var(--unit-week-fill-2); border-color: var(--unit-week-fill-2); }
        .contrib-square.unit-week-fill-3 { background-color: var(--unit-week-fill-3); border-color: var(--unit-week-fill-3); }
        .contrib-square.unit-week-fill-4 { background-color: var(--unit-week-fill-4); border-color: var(--unit-week-fill-4); }
        .contrib-square.unit-week-fill-5 { background-color: var(--unit-week-fill-5); border-color: var(--unit-week-fill-5); }
        .contrib-square.unit-week-fill-6 { background-color: var(--unit-week-fill-6); border-color: var(--unit-week-fill-6); }
        .contrib-square.unit-week-fill-7 { background-color: var(--unit-week-fill-7); border-color: var(--unit-week-fill-7); }
        .contrib-square.unit-week-fill-8 { background-color: var(--unit-week-fill-8); border-color: var(--unit-week-fill-8); }
        .contrib-square.unit-week-fill-9 { background-color: var(--unit-week-fill-9); border-color: var(--unit-week-fill-9); }
        .contrib-square.unit-week-fill-10 { background-color: var(--unit-week-fill-10); border-color: var(--unit-week-fill-10); }
        .contrib-square.unit-week-fill-11 { background-color: var(--unit-week-fill-11); border-color: var(--unit-week-fill-11); }
        .contrib-square.unit-week-fill-12 { background-color: var(--unit-week-fill-12); border-color: var(--unit-week-fill-12); }
        .contrib-square.unit-week-fill-13 { background-color: var(--unit-week-fill-13); border-color: var(--unit-week-fill-13); }
        .contrib-square.unit-week-fill-14 { background-color: var(--unit-week-fill-14); border-color: var(--unit-week-fill-14); }
        .contrib-square.unit-week-fill-15 { background-color: var(--unit-week-fill-15); border-color: var(--unit-week-fill-15); }

        /* Unit Grid Gradient Fill Styles (Months - 15 Levels) */
        .contrib-square.unit-month-fill-1 { background-color: var(--unit-month-fill-1); border-color: var(--unit-month-fill-1); }
        .contrib-square.unit-month-fill-2 { background-color: var(--unit-month-fill-2); border-color: var(--unit-month-fill-2); }
        .contrib-square.unit-month-fill-3 { background-color: var(--unit-month-fill-3); border-color: var(--unit-month-fill-3); }
        .contrib-square.unit-month-fill-4 { background-color: var(--unit-month-fill-4); border-color: var(--unit-month-fill-4); }
        .contrib-square.unit-month-fill-5 { background-color: var(--unit-month-fill-5); border-color: var(--unit-month-fill-5); }
        .contrib-square.unit-month-fill-6 { background-color: var(--unit-month-fill-6); border-color: var(--unit-month-fill-6); }
        .contrib-square.unit-month-fill-7 { background-color: var(--unit-month-fill-7); border-color: var(--unit-month-fill-7); }
        .contrib-square.unit-month-fill-8 { background-color: var(--unit-month-fill-8); border-color: var(--unit-month-fill-8); }
        .contrib-square.unit-month-fill-9 { background-color: var(--unit-month-fill-9); border-color: var(--unit-month-fill-9); }
        .contrib-square.unit-month-fill-10 { background-color: var(--unit-month-fill-10); border-color: var(--unit-month-fill-10); }
        .contrib-square.unit-month-fill-11 { background-color: var(--unit-month-fill-11); border-color: var(--unit-month-fill-11); }
        .contrib-square.unit-month-fill-12 { background-color: var(--unit-month-fill-12); border-color: var(--unit-month-fill-12); }
        .contrib-square.unit-month-fill-13 { background-color: var(--unit-month-fill-13); border-color: var(--unit-month-fill-13); }
        .contrib-square.unit-month-fill-14 { background-color: var(--unit-month-fill-14); border-color: var(--unit-month-fill-14); }
        .contrib-square.unit-month-fill-15 { background-color: var(--unit-month-fill-15); border-color: var(--unit-month-fill-15); }

        /* Unit Grid Gradient Fill Styles (Hours - 15 Levels) */
        .contrib-square.unit-hour-fill-1 { background-color: var(--unit-hour-fill-1); border-color: var(--unit-hour-fill-1); }
        .contrib-square.unit-hour-fill-2 { background-color: var(--unit-hour-fill-2); border-color: var(--unit-hour-fill-2); }
        .contrib-square.unit-hour-fill-3 { background-color: var(--unit-hour-fill-3); border-color: var(--unit-hour-fill-3); }
        .contrib-square.unit-hour-fill-4 { background-color: var(--unit-hour-fill-4); border-color: var(--unit-hour-fill-4); }
        .contrib-square.unit-hour-fill-5 { background-color: var(--unit-hour-fill-5); border-color: var(--unit-hour-fill-5); }
        .contrib-square.unit-hour-fill-6 { background-color: var(--unit-hour-fill-6); border-color: var(--unit-hour-fill-6); }
        .contrib-square.unit-hour-fill-7 { background-color: var(--unit-hour-fill-7); border-color: var(--unit-hour-fill-7); }
        .contrib-square.unit-hour-fill-8 { background-color: var(--unit-hour-fill-8); border-color: var(--unit-hour-fill-8); }
        .contrib-square.unit-hour-fill-9 { background-color: var(--unit-hour-fill-9); border-color: var(--unit-hour-fill-9); }
        .contrib-square.unit-hour-fill-10 { background-color: var(--unit-hour-fill-10); border-color: var(--unit-hour-fill-10); }
        .contrib-square.unit-hour-fill-11 { background-color: var(--unit-hour-fill-11); border-color: var(--unit-hour-fill-11); }
        .contrib-square.unit-hour-fill-12 { background-color: var(--unit-hour-fill-12); border-color: var(--unit-hour-fill-12); }
        .contrib-square.unit-hour-fill-13 { background-color: var(--unit-hour-fill-13); border-color: var(--unit-hour-fill-13); }
        .contrib-square.unit-hour-fill-14 { background-color: var(--unit-hour-fill-14); border-color: var(--unit-hour-fill-14); }
        .contrib-square.unit-hour-fill-15 { background-color: var(--unit-hour-fill-15); border-color: var(--unit-hour-fill-15); }

        /* Unit Grid Gradient Fill Styles (Prime Years - 15 Levels) */
        .contrib-square.unit-primeYear-fill-1 { background-color: var(--unit-primeYear-fill-1); border-color: var(--unit-primeYear-fill-1); }
        .contrib-square.unit-primeYear-fill-2 { background-color: var(--unit-primeYear-fill-2); border-color: var(--unit-primeYear-fill-2); }
        .contrib-square.unit-primeYear-fill-3 { background-color: var(--unit-primeYear-fill-3); border-color: var(--unit-primeYear-fill-3); }
        .contrib-square.unit-primeYear-fill-4 { background-color: var(--unit-primeYear-fill-4); border-color: var(--unit-primeYear-fill-4); }
        .contrib-square.unit-primeYear-fill-5 { background-color: var(--unit-primeYear-fill-5); border-color: var(--unit-primeYear-fill-5); }
        .contrib-square.unit-primeYear-fill-6 { background-color: var(--unit-primeYear-fill-6); border-color: var(--unit-primeYear-fill-6); }
        .contrib-square.unit-primeYear-fill-7 { background-color: var(--unit-primeYear-fill-7); border-color: var(--unit-primeYear-fill-7); }
        .contrib-square.unit-primeYear-fill-8 { background-color: var(--unit-primeYear-fill-8); border-color: var(--unit-primeYear-fill-8); }
        .contrib-square.unit-primeYear-fill-9 { background-color: var(--unit-primeYear-fill-9); border-color: var(--unit-primeYear-fill-9); }
        .contrib-square.unit-primeYear-fill-10 { background-color: var(--unit-primeYear-fill-10); border-color: var(--unit-primeYear-fill-10); }
        .contrib-square.unit-primeYear-fill-11 { background-color: var(--unit-primeYear-fill-11); border-color: var(--unit-primeYear-fill-11); }
        .contrib-square.unit-primeYear-fill-12 { background-color: var(--unit-primeYear-fill-12); border-color: var(--unit-primeYear-fill-12); }
        .contrib-square.unit-primeYear-fill-13 { background-color: var(--unit-primeYear-fill-13); border-color: var(--unit-primeYear-fill-13); }
        .contrib-square.unit-primeYear-fill-14 { background-color: var(--unit-primeYear-fill-14); border-color: var(--unit-primeYear-fill-14); }
        .contrib-square.unit-primeYear-fill-15 { background-color: var(--unit-primeYear-fill-15); border-color: var(--unit-primeYear-fill-15); }

        /* Unit Grid Gradient Fill Styles (Awake Slots - 15 Levels) */
        .contrib-square.unit-awakeSlot-fill-1 { background-color: var(--unit-awakeSlot-fill-1); border-color: var(--unit-awakeSlot-fill-1); }
        .contrib-square.unit-awakeSlot-fill-2 { background-color: var(--unit-awakeSlot-fill-2); border-color: var(--unit-awakeSlot-fill-2); }
        .contrib-square.unit-awakeSlot-fill-3 { background-color: var(--unit-awakeSlot-fill-3); border-color: var(--unit-awakeSlot-fill-3); }
        .contrib-square.unit-awakeSlot-fill-4 { background-color: var(--unit-awakeSlot-fill-4); border-color: var(--unit-awakeSlot-fill-4); }
        .contrib-square.unit-awakeSlot-fill-5 { background-color: var(--unit-awakeSlot-fill-5); border-color: var(--unit-awakeSlot-fill-5); }
        .contrib-square.unit-awakeSlot-fill-6 { background-color: var(--unit-awakeSlot-fill-6); border-color: var(--unit-awakeSlot-fill-6); }
        .contrib-square.unit-awakeSlot-fill-7 { background-color: var(--unit-awakeSlot-fill-7); border-color: var(--unit-awakeSlot-fill-7); }
        .contrib-square.unit-awakeSlot-fill-8 { background-color: var(--unit-awakeSlot-fill-8); border-color: var(--unit-awakeSlot-fill-8); }
        .contrib-square.unit-awakeSlot-fill-9 { background-color: var(--unit-awakeSlot-fill-9); border-color: var(--unit-awakeSlot-fill-9); }
        .contrib-square.unit-awakeSlot-fill-10 { background-color: var(--unit-awakeSlot-fill-10); border-color: var(--unit-awakeSlot-fill-10); }
        .contrib-square.unit-awakeSlot-fill-11 { background-color: var(--unit-awakeSlot-fill-11); border-color: var(--unit-awakeSlot-fill-11); }
        .contrib-square.unit-awakeSlot-fill-12 { background-color: var(--unit-awakeSlot-fill-12); border-color: var(--unit-awakeSlot-fill-12); }
        .contrib-square.unit-awakeSlot-fill-13 { background-color: var(--unit-awakeSlot-fill-13); border-color: var(--unit-awakeSlot-fill-13); }
        .contrib-square.unit-awakeSlot-fill-14 { background-color: var(--unit-awakeSlot-fill-14); border-color: var(--unit-awakeSlot-fill-14); }
        .contrib-square.unit-awakeSlot-fill-15 { background-color: var(--unit-awakeSlot-fill-15); border-color: var(--unit-awakeSlot-fill-15); }

        /* NEW: Unit Grid Gradient Fill Styles (Day Slots - 15 Levels) */
        .contrib-square.unit-daySlot-fill-1 { background-color: var(--unit-daySlot-fill-1); border-color: var(--unit-daySlot-fill-1); }
        .contrib-square.unit-daySlot-fill-2 { background-color: var(--unit-daySlot-fill-2); border-color: var(--unit-daySlot-fill-2); }
        .contrib-square.unit-daySlot-fill-3 { background-color: var(--unit-daySlot-fill-3); border-color: var(--unit-daySlot-fill-3); }
        .contrib-square.unit-daySlot-fill-4 { background-color: var(--unit-daySlot-fill-4); border-color: var(--unit-daySlot-fill-4); }
        .contrib-square.unit-daySlot-fill-5 { background-color: var(--unit-daySlot-fill-5); border-color: var(--unit-daySlot-fill-5); }
        .contrib-square.unit-daySlot-fill-6 { background-color: var(--unit-daySlot-fill-6); border-color: var(--unit-daySlot-fill-6); }
        .contrib-square.unit-daySlot-fill-7 { background-color: var(--unit-daySlot-fill-7); border-color: var(--unit-daySlot-fill-7); }
        .contrib-square.unit-daySlot-fill-8 { background-color: var(--unit-daySlot-fill-8); border-color: var(--unit-daySlot-fill-8); }
        .contrib-square.unit-daySlot-fill-9 { background-color: var(--unit-daySlot-fill-9); border-color: var(--unit-daySlot-fill-9); }
        .contrib-square.unit-daySlot-fill-10 { background-color: var(--unit-daySlot-fill-10); border-color: var(--unit-daySlot-fill-10); }
        .contrib-square.unit-daySlot-fill-11 { background-color: var(--unit-daySlot-fill-11); border-color: var(--unit-daySlot-fill-11); }
        .contrib-square.unit-daySlot-fill-12 { background-color: var(--unit-daySlot-fill-12); border-color: var(--unit-daySlot-fill-12); }
        .contrib-square.unit-daySlot-fill-13 { background-color: var(--unit-daySlot-fill-13); border-color: var(--unit-daySlot-fill-13); }
        .contrib-square.unit-daySlot-fill-14 { background-color: var(--unit-daySlot-fill-14); border-color: var(--unit-daySlot-fill-14); }
        .contrib-square.unit-daySlot-fill-15 { background-color: var(--unit-daySlot-fill-15); border-color: var(--unit-daySlot-fill-15); }


        /* Current month/hour/unit square style */
        .contrib-square.current {
            outline: 1.5px solid var(--contrib-current-border); /* Thinner outline */
            outline-offset: 1px;
            /* Ensure current color overrides gradient fill */
            background-color: var(--tile-current-bg) !important;
            border-color: var(--tile-current-border) !important;
            z-index: 5; /* Bring current square slightly forward */
        }
        /* Highlight for the current hour OR upcoming unit OR current awake slot (using the same style) */
        .contrib-square.unit-current {
            outline: 1.5px solid var(--unit-current-border);
            outline-offset: 1px;
            background-color: var(--unit-current-bg) !important;
            border-color: var(--unit-current-border) !important;
            z-index: 5;
        }

        /* --- Input and Button Styles using Variables --- */
        input[type="date"], input[type="number"], button {
            @apply rounded-md px-3 py-2 shadow-sm text-sm sm:text-base transition-colors duration-200;
            border: 1px solid var(--input-border);
            background-color: var(--input-bg);
            color: var(--input-text);
        }
        input[type="date"]:focus, input[type="number"]:focus, button:focus {
             @apply outline-none ring-2;
             border-color: var(--input-focus-ring);
             box-shadow: 0 0 0 2px var(--input-focus-ring); /* Simulate ring */
        }
        button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border-color: transparent;
            cursor: pointer; /* Ensure buttons have pointer cursor */
        }
        button:not(.theme-button):hover {
            background-color: var(--button-hover-bg);
        }
        button.cancel-btn {
             background-color: var(--button-cancel-bg);
             color: var(--button-cancel-text);
             border-color: var(--input-border);
        }
        button.cancel-btn:hover {
            background-color: var(--button-cancel-hover-bg);
        }
        input[type="number"] {
            @apply w-20 text-center; /* Style number inputs */
        }

        /* --- Info Tile Content Styles using Variables --- */
        .info-tile-content label { @apply font-medium whitespace-nowrap text-sm mb-1 block; color: var(--text-color); }
        .info-tile-content p { @apply text-sm; color: var(--text-muted-color); }
        .info-tile-content span { @apply font-semibold; color: var(--text-color); }
        .birthdate-status { @apply text-sm mb-2 inline-flex items-center; color: var(--text-muted-color); } /* Modified for inline icon */
        #birthDateError { @apply text-red-500 text-xs mt-1 h-4; }
        #settingsStatus { @apply text-sm mt-2 h-4; } /* Height for settings status */

        /* --- Icons using Variables --- */
        .info-tile-content svg { color: var(--icon-color); }
        /* Style for the status icon */
        #birthDateStatusIcon svg {
            width: 1.1rem; /* Slightly larger */
            height: 1.1rem;
            margin-left: 0.3rem; /* Space between text and icon */
            vertical-align: middle; /* Align icon with text */
        }
        .icon-tick { color: var(--icon-tick-color); }
        .icon-cross { color: var(--icon-cross-color); }

        /* --- Section Styles using Variables --- */
        .section-container {
            background-color: var(--section-bg);
            box-shadow: var(--section-shadow);
            @apply p-4 sm:p-6 rounded-lg;
        }
        /* Specific padding for progress grids */
        .progress-grid-container {
             @apply p-2 sm:p-3 rounded-lg; /* Reduced padding */
        }

        /* --- Settings Icon Button --- */
        #settingsIconBtn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem;
            border-radius: 50%; /* Make it circular */
            background-color: transparent;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease;
            z-index: 40; /* Ensure it's above most content */
        }
        #settingsIconBtn:hover {
            background-color: var(--settings-icon-hover-bg);
        }
        #settingsIconBtn svg {
            width: 1.5rem;
            height: 1.5rem;
            color: var(--settings-icon-color);
        }

        /* --- Settings Modal Styles --- */
        #modalOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-overlay-bg);
            z-index: 45; /* Below modal, above content */
            transition: opacity 0.3s ease-in-out;
        }
        #modalOverlay.hidden {
            opacity: 0;
            pointer-events: none; /* Prevent interaction when hidden */
        }
        #settingsModal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--modal-bg);
            border: 1px solid var(--modal-border);
            border-radius: 0.75rem; /* lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1); /* lg */
            padding: 1.5rem; /* p-6 */
            width: 90%;
            max-width: 500px; /* Limit max width */
            z-index: 50; /* Highest */
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
         #settingsModal.hidden {
             opacity: 0;
             transform: translate(-50%, -45%); /* Slight move up when hiding */
             pointer-events: none; /* Prevent interaction when hidden */
         }
        #settingsModal h2 {
            @apply text-xl font-semibold mb-4 text-center;
             color: var(--heading-color);
        }
        #closeSettingsModalBtn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background: transparent;
            border: none;
            padding: 0.25rem;
            border-radius: 50%;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        #closeSettingsModalBtn:hover {
            background-color: var(--modal-close-icon-hover-bg);
        }
        #closeSettingsModalBtn svg {
            width: 1.25rem;
            height: 1.25rem;
            color: var(--modal-close-icon-color);
        }
        .modal-content {
             @apply space-y-4;
        }
        .modal-content label {
             @apply font-medium text-sm;
             color: var(--text-color);
        }
        .modal-grid {
            /* Keep 2 columns on small screens and up */
             @apply grid grid-cols-2 gap-x-6 gap-y-4 items-center;
        }
        /* Ensure labels and inputs align nicely */
        .modal-grid > div {
            @apply flex flex-col; /* Stack label above input */
        }
         .modal-grid > div > label {
             @apply mb-1; /* Add space below label */
         }
         .modal-grid > div > input {
             @apply w-full; /* Make input take full width */
         }

    </style>
</head>
<body class="p-4 md:p-8 relative">
    <button id="settingsIconBtn" title="Open Settings">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
    </button>

    <div class="max-w-7xl mx-auto space-y-8">
        <h1 class="text-3xl font-bold text-center mb-4" title="Visualize your life's journey, track progress, and stay motivated towards your goals.">Life Grid</h1>
         <p class="text-lg text-center mb-1" style="color: var(--text-muted-color);">
         Life Grid is a minimalist web app that helps you visualize your time. By inputting your age and desired lifespan, it shows how much time has passed and what's left, encouraging reflection and intentional living. Start visualizing your time today.
         </p>
         <p class="text-xs text-center mb-4" style="color: var(--text-muted-color);">
             by <a href="https://www.linkedin.com/in/karthicobla/" target="_blank" rel="noopener noreferrer" title="Visit Karthic Obla's LinkedIn profile" style="color: var(--link-color);" class="hover:underline" onmouseover="this.style.color='var(--link-hover-color)'" onmouseout="this.style.color='var(--link-color)'">Karthic Obla</a>
         </p>

        <div class="theme-switcher" title="Choose your preferred visual theme.">
            <button id="themeBtnLight" class="theme-button" data-theme="light" aria-label="Switch to Light Theme" title="Calm Light Theme">
                <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
                </svg>
            </button>
            <button id="themeBtnDark" class="theme-button" data-theme="dark" aria-label="Switch to Dark Theme" title="Cool Dark Theme">
                <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                  <path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z" clip-rule="evenodd" />
                </svg>
            </button>
            <button id="themeBtnColorful" class="theme-button" data-theme="colorful" aria-label="Switch to Colorful Theme" title="Fun Colorful Theme">
                <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.994 15.994 0 011.622-3.395m3.42 3.42a15.995 15.995 0 004.764-4.648l3.876-5.814a1.151 1.151 0 00-1.597-1.597L14.146 6.32a15.996 15.996 0 00-4.649 4.763m3.42 3.42a6.776 6.776 0 00-3.42-3.42" />
                </svg>
            </button>
            <button id="themeBtnCyberpunk" class="theme-button" data-theme="cyberpunk" aria-label="Switch to Cyberpunk Theme" title="Cyberpunk Theme">
                <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                </svg>
            </button>
            <button id="themeBtnDarkOcean" class="theme-button" data-theme="dark-ocean" aria-label="Switch to Dark Ocean Theme" title="Dark Ocean Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75c0 8.284 6.716 15 15 15h1.5" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12c0 4.97 4.03 9 9 9h1.5" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 17.25c0 2.76 2.24 5 5 5h1.5" />
    </svg>
</button>

<button id="themeBtnDarkForest" class="theme-button" data-theme="dark-forest" aria-label="Switch to Dark Forest Theme" title="Dark Forest Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M15.402 17.162a2.25 2.25 0 01-2.804 0l-4.006-4.006a2.25 2.25 0 010-3.182l4.006-4.006a2.25 2.25 0 012.804 0l4.006 4.006a2.25 2.25 0 010 3.182l-4.006 4.006zM8.601 4.138a2.25 2.25 0 012.804 0l4.006 4.006a2.25 2.25 0 010 3.182l-4.006 4.006a2.25 2.25 0 01-2.804 0l-4.006-4.006a2.25 2.25 0 010-3.182l4.006-4.006z" />
    </svg>
</button>

<button id="themeBtnKidsRainbow" class="theme-button" data-theme="kids-rainbow" aria-label="Switch to Kids Rainbow Theme" title="Kids Rainbow Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.31h5.418a.563.563 0 01.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 21.07a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988h5.418a.563.563 0 00.475-.31L11.48 3.5z" />
    </svg>
</button>

<button id="themeBtnKidsSpace" class="theme-button" data-theme="kids-space" aria-label="Switch to Kids Space Theme" title="Kids Space Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9 9 0 100-18 9 9 0 000 18z" />
      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 7.5c-.412 0-.82.066-1.215.19a8.94 8.94 0 00-4.07 0A8.963 8.963 0 008.25 7.5c-.412 0-.82.066-1.215.19M12 15.75a8.94 8.94 0 014.5-1.185M7.785 15.94a8.963 8.963 0 014.215-.19m-4.215.19c.412 0 .82-.066 1.215-.19" />
    </svg>
</button>

<button id="themeBtnTwilightDusk" class="theme-button" data-theme="twilight-dusk" aria-label="Switch to Twilight Dusk Theme" title="Twilight Dusk Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
      <path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z" clip-rule="evenodd" />
    </svg>
</button>

<button id="themeBtnTwilightDawn" class="theme-button" data-theme="twilight-dawn" aria-label="Switch to Twilight Dawn Theme" title="Twilight Dawn Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
    </svg>
</button>

<button id="themeBtnCyberpunkNeon" class="theme-button" data-theme="cyberpunk-neon" aria-label="Switch to Cyberpunk Neon Theme" title="Cyberpunk Neon Theme">
    <svg class="theme-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 002.25-2.25V8.25a2.25 2.25 0 00-2.25-2.25H6.75A2.25 2.25 0 004.5 8.25v7.5a2.25 2.25 0 002.25 2.25z" />
    </svg>
</button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-stretch">
            <div class="tile p-4" title="Set your birth date here to personalize the tracker and enable all calculations.">
                 <div class="info-tile-content w-full flex flex-col items-center">
                     <div id="birthDateDisplay" class="text-center">
                         <p id="birthDateStatus" class="birthdate-status">
                             Birth Date Not Set
                             <span id="birthDateStatusIcon" class="inline-block"></span>
                         </p>
                         <button id="changeBirthDateBtn" class="w-full sm:w-auto px-4 mt-2">Set Birth Date</button>
                     </div>
                     <div id="birthDateInputGroup" class="hidden w-full mt-2">
                         <label for="birthDate" class="sr-only">Your Birth Date:</label>
                         <input type="date" id="birthDate" class="w-full mb-2">
                         <div class="flex flex-col sm:flex-row items-center justify-center gap-2">
                             <button id="saveBirthDateBtn" class="w-full sm:w-auto px-4 flex-grow">Save</button>
                             <button id="cancelBirthDateBtn" class="w-full sm:w-auto px-4 cancel-btn flex-grow">Cancel</button>
                         </div>
                         <p id="birthDateError" class="text-red-500 text-xs mt-1 h-4"></p>
                     </div>
                 </div>
            </div>
            <div class="tile p-4" title="Displays the current calendar year and your calculated age based on the birth date set.">
                 <div id="userInfo" class="info-tile-content flex flex-col justify-center items-center w-full h-full">
                     <p>Current Year: <span id="displayCurrentYear">----</span></p>
                     <p>Your Age: <span id="currentAge">--</span></p>
                 </div>
            </div>
            <div class="tile p-4" title="Shows the countdown for the current 30-minute slot and the number of slots passed today.">
                 <div class="info-tile-content flex flex-col justify-center items-center w-full h-full gap-2">
                     <div class="label">Current 30-Min Slot</div>
                     <div id="slotCountdown" class="value text-2xl">--:--</div>
                     <p id="slotsPassedToday" class="text-xs" style="color: var(--text-muted-color);">-- slots passed today</p>
                     
                 </div>
                
        <!--</div>-->
            </div>
            <div class="tile p-4" title="Shows the current date and time, updated every second.">
                 <div class="info-tile-content flex flex-col justify-center items-center w-full h-full gap-3">
                     <div class="flex items-center gap-2">
                         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6">
                           <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75z" clip-rule="evenodd" />
                         </svg>
                         <span id="displayCurrentDate" class="text-lg font-semibold">-- --- ----</span>
                     </div>
                     <div class="flex items-center gap-2">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-6 w-6">
                           <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
                         </svg>
                         <span id="displayCurrentTime" class="text-lg font-semibold">--:--:-- --</span>
                     </div>
                 </div>
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-6 justify-between items-start mt-4">
            <div class="w-full lg:w-auto flex-1 min-w-0 space-y-2">
                <h3 id="yearCountdownTitle" class="time-group-label" title="Time remaining in the current calendar year.">What's left this year</h3>
                <div class="grid grid-cols-3 gap-2">
                    <div class="tile clickable" title="Days remaining in this year."> <div class="label">Days Left</div> <div id="daysLeftYear" class="value">--</div> </div>
                    <div class="tile clickable" title="Weeks remaining in this year."> <div class="label">Weeks Left</div> <div id="weeksLeftYear" class="value">--</div> </div>
                    <div class="tile clickable" title="Full months remaining in this year."> <div class="label">Months Left</div> <div id="monthsLeftYear" class="value">--</div> </div>
                </div>
                <div class="contrib-grid-wrapper" title="Visual representation of weeks remaining this year. Each square is a week. Brighter squares are further in the future. The highlighted square is the upcoming week.">
                    <div class="contrib-grid-header">
                        <h4 class="contrib-grid-label text-xs">Weeks Remaining This Year</h4>
                        <span id="yearWeeksCount" class="progress-percent-text text-xs">(--/52)</span>
                    </div>
                    <div id="yearWeeksContribGrid" class="contrib-grid unit-grid"></div>
                </div>
                <div class="contrib-grid-wrapper" title="Visual representation of months remaining this year. Each square is a month. Brighter squares are further in the future. The highlighted square is the upcoming month.">
                    <div class="contrib-grid-header">
                        <h4 class="contrib-grid-label text-xs">Months Remaining This Year</h4>
                         <span id="yearMonthsCount" class="progress-percent-text text-xs">(--/12)</span>
                    </div>
                    <div id="yearMonthsContribGrid" class="contrib-grid unit-grid"></div>
                </div>
            </div>
            <div class="w-full lg:w-auto flex-1 min-w-0 space-y-2">
                 <h3 id="todayCountdownTitle" class="time-group-label" title="Time remaining today. Make every moment count!">What's left today</h3>
                <div class="grid grid-cols-3 gap-2">
                    <div class="tile clickable" title="Hours left today."> <div class="label">Hours Left</div> <div id="hoursLeftDay" class="value">--</div> </div>
                    <div class="tile clickable" title="Minutes left today."> <div class="label">Minutes Left</div> <div id="minutesLeftDay" class="value">--</div> </div>
                    <div class="tile clickable" title="Seconds ticking away today."> <div class="label">Seconds Left</div> <div id="secondsLeftDay" class="value">--</div> </div>
                </div>
                 <div class="contrib-grid-wrapper" title="Visual representation of hours remaining today. Past hours are dim, current hour is highlighted, future hours use a gradient.">
                     <div class="contrib-grid-header">
                        <h4 class="contrib-grid-label text-xs">Hours Remaining Today</h4>
                         <span id="todayHoursCount" class="progress-percent-text text-xs">(--/24)</span>
                    </div>
                    <div id="todayHoursContribGrid" class="contrib-grid unit-grid"></div>
                </div>
                <div id="awakeSlotsGridWrapper" class="contrib-grid-wrapper" title="Visual representation of 30-minute slots from {awakeStartHour}:00 to {awakeEndHour}:00. Past slots are dim, current slot is highlighted, future slots use a gradient.">
                     <div class="contrib-grid-header">
                        <h4 id="awakeSlotsGridLabel" class="contrib-grid-label text-xs">Active Hours (-- AM - -- PM)</h4>
                         <span id="awakeSlotsCount" class="progress-percent-text text-xs">(--/--)</span>
                    </div>
                    <div id="awakeSlotsContribGrid" class="contrib-grid unit-grid"></div>
                </div>
                </div>
            <div class="w-full lg:w-auto flex-1 min-w-0 space-y-2">
                 <h3 class="time-group-label" title="Time remaining in your prime working years (defined as 0-{primeYearsEnd}).">Remaining Prime Time</h3>
                <div class="grid grid-cols-3 gap-2">
                    <div class="tile clickable" title="Full years remaining until the end of your prime period (age {primeYearsEnd})."> <div class="label">Years Left</div> <div id="primeYearsLeft" class="value">--</div> </div>
                    <div class="tile clickable" title="Full months remaining until the end of your prime period."> <div class="label">Months Left</div> <div id="primeMonthsLeft" class="value">--</div> </div>
                    <div class="tile clickable" title="Approximate weeks remaining until the end of your prime period."> <div class="label">Weeks Left</div> <div id="primeWeeksLeft" class="value">--</div> </div>
                </div>
                 <div class="contrib-grid-wrapper" title="Visual representation of years remaining in your prime period (0-{primeYearsEnd}). Each square is a year. Brighter squares are further in the future. The highlighted square is the upcoming prime year.">
                     <div class="contrib-grid-header">
                        <h4 class="contrib-grid-label text-xs">Prime Years Remaining</h4>
                         <span id="primeYearsCount" class="progress-percent-text text-xs">(--/--)</span>
                    </div>
                    <div id="primeYearsContribGrid" class="contrib-grid unit-grid"></div>
                 </div>
            </div>
        </div>

        <h2 class="text-center text-xl font-semibold mt-8 mb-2">Life Progress</h2>
        <div class="grid grid-cols-1 gap-4">
            <div class="contrib-grid-wrapper" title="Shows your progress through your defined lifespan ({maxLifeYears} years). Each square is a year. Darker squares are more recent. The outlined square is the current year.">
                <div class="contrib-grid-header">
                    <h3 id="lifespanYearProgressLabel" class="contrib-grid-label">Overall Life Progress (Years)</h3>
                    <span id="lifespanYearPercentText" class="progress-percent-text">--%</span>
                </div>
                <div id="lifespanYearContribGrid" class="contrib-grid progress-grid-container">
                    </div>
            </div>

            <div class="contrib-grid-wrapper" title="Shows how much of your prime working years (0-{primeYearsEnd * 12} months) you have completed. Each square is a prime month. Darker squares are more recent. The outlined square is the current month.">
                 <div class="contrib-grid-header">
                    <h3 id="primeProgressLabel" class="contrib-grid-label">Prime Years Progress (Months)</h3>
                    <span id="primePercentText" class="progress-percent-text">--%</span>
                </div>
                <div id="primeContribGrid" class="contrib-grid progress-grid-container">
                    </div>
            </div>

            <div class="contrib-grid-wrapper" title="Shows your progress through your defined lifespan ({maxLifeYears * 12} months). Each square is a month. Darker squares are more recent. The outlined square is the current month.">
                <div class="contrib-grid-header">
                    <h3 id="lifespanProgressLabel" class="contrib-grid-label">Overall Life Progress (Months)</h3>
                    <span id="lifespanPercentText" class="progress-percent-text">--%</span>
                </div>
                <div id="lifespanContribGrid" class="contrib-grid progress-grid-container">
                    </div>
            </div>

        </div>

    </div>

    <div id="modalOverlay" class="hidden"></div>
    <div id="settingsModal" class="hidden" role="dialog" aria-modal="true" aria-labelledby="settingsModalTitle">
        <h2 id="settingsModalTitle">Settings</h2>
        <button id="closeSettingsModalBtn" title="Close Settings" aria-label="Close Settings">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
        <div class="modal-content">
            <div class="modal-grid">
                <div>
                    <label for="maxLifespanInput">Max Lifespan (Yrs):</label>
                    <input type="number" id="maxLifespanInput" min="1" step="1">
                </div>
                <div>
                    <label for="primeEndAgeInput">Prime End Age:</label>
                    <input type="number" id="primeEndAgeInput" min="1" step="1">
                </div>
                <div>
                    <label for="awakeStartHourInput">Awake Start (Hr):</label>
                    <input type="number" id="awakeStartHourInput" min="0" max="23" step="1">
                </div>
                 <div>
                    <label for="awakeEndHourInput">Awake End (Hr):</label>
                    <input type="number" id="awakeEndHourInput" min="0" max="23" step="1">
                </div>
            </div>
            <button id="saveSettingsBtn" class="mt-4 w-full">Save Settings</button>
            <p id="settingsStatus" class="text-sm mt-2 h-4 text-center"></p>
        </div>
    </div>

    <script>
        // --- DOM Elements (Cached) ---
        const bodyElement = document.body;
        const birthDateDisplay = document.getElementById('birthDateDisplay');
        const birthDateStatus = document.getElementById('birthDateStatus');
        const birthDateStatusIcon = document.getElementById('birthDateStatusIcon');
        const changeBirthDateBtn = document.getElementById('changeBirthDateBtn');
        const birthDateInputGroup = document.getElementById('birthDateInputGroup');
        const birthDateInput = document.getElementById('birthDate');
        const saveBirthDateBtn = document.getElementById('saveBirthDateBtn');
        const cancelBirthDateBtn = document.getElementById('cancelBirthDateBtn');
        const birthDateError = document.getElementById('birthDateError');
        const displayCurrentDateSpan = document.getElementById('displayCurrentDate');
        const displayCurrentTimeSpan = document.getElementById('displayCurrentTime');
        const displayCurrentYearSpan = document.getElementById('displayCurrentYear');
        const currentAgeSpan = document.getElementById('currentAge');
        // Slot Countdown Elements
        const slotCountdownSpan = document.getElementById('slotCountdown');
        const slotsPassedTodaySpan = document.getElementById('slotsPassedToday');
        // Countdown Title Elements
        const yearCountdownTitle = document.getElementById('yearCountdownTitle');
        const todayCountdownTitle = document.getElementById('todayCountdownTitle');
        // Countdown Value Elements
        const daysLeftYearSpan = document.getElementById('daysLeftYear');
        const weeksLeftYearSpan = document.getElementById('weeksLeftYear');
        const monthsLeftYearSpan = document.getElementById('monthsLeftYear');
        const hoursLeftDaySpan = document.getElementById('hoursLeftDay');
        const minutesLeftDaySpan = document.getElementById('minutesLeftDay');
        const secondsLeftDaySpan = document.getElementById('secondsLeftDay');
        // Prime Countdown Elements
        const primeYearsLeftSpan = document.getElementById('primeYearsLeft');
        const primeWeeksLeftSpan = document.getElementById('primeWeeksLeft');
        const primeMonthsLeftSpan = document.getElementById('primeMonthsLeft');
        // Progress Grid Elements
        const lifespanProgressLabel = document.getElementById('lifespanProgressLabel');
        const lifespanPercentText = document.getElementById('lifespanPercentText');
        const lifespanContribGrid = document.getElementById('lifespanContribGrid');
        const primeProgressLabel = document.getElementById('primeProgressLabel');
        const primePercentText = document.getElementById('primePercentText');
        const primeContribGrid = document.getElementById('primeContribGrid');
        const lifespanYearProgressLabel = document.getElementById('lifespanYearProgressLabel');
        const lifespanYearPercentText = document.getElementById('lifespanYearPercentText');
        const lifespanYearContribGrid = document.getElementById('lifespanYearContribGrid');
        // Theme switcher buttons
        const themeButtons = document.querySelectorAll('.theme-button'); // Selects all theme buttons
        // Settings Elements
        const settingsIconBtn = document.getElementById('settingsIconBtn');
        const settingsModal = document.getElementById('settingsModal');
        const modalOverlay = document.getElementById('modalOverlay');
        const closeSettingsModalBtn = document.getElementById('closeSettingsModalBtn');
        const maxLifespanInput = document.getElementById('maxLifespanInput');
        const primeEndAgeInput = document.getElementById('primeEndAgeInput');
        const awakeStartHourInput = document.getElementById('awakeStartHourInput');
        const awakeEndHourInput = document.getElementById('awakeEndHourInput');
        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        const settingsStatus = document.getElementById('settingsStatus');
         // Unit Contribution Grid Elements
         const yearWeeksContribGrid = document.getElementById('yearWeeksContribGrid');
         const yearMonthsContribGrid = document.getElementById('yearMonthsContribGrid');
         const todayHoursContribGrid = document.getElementById('todayHoursContribGrid');
         const primeYearsContribGrid = document.getElementById('primeYearsContribGrid');
         const awakeSlotsContribGrid = document.getElementById('awakeSlotsContribGrid');
         // NEW: Day Slots Grid Elements
         const daySlotsGridLabel = document.getElementById('daySlotsGridLabel');
         const daySlotsCount = document.getElementById('daySlotsCount');
         const daySlotsContribGrid = document.getElementById('daySlotsContribGrid');
         // Unit Contribution Count Spans
         const yearWeeksCountSpan = document.getElementById('yearWeeksCount');
         const yearMonthsCountSpan = document.getElementById('yearMonthsCount');
         const todayHoursCountSpan = document.getElementById('todayHoursCount');
         const primeYearsCountSpan = document.getElementById('primeYearsCount');
         const awakeSlotsCountSpan = document.getElementById('awakeSlotsCount');
         // Awake Grid Label/Wrapper (for updating text/title)
         const awakeSlotsGridWrapper = document.getElementById('awakeSlotsGridWrapper');
         const awakeSlotsGridLabel = document.getElementById('awakeSlotsGridLabel');


        // --- State Variables ---
        let birthDate = null;
        let currentAge = null; // Age in years
        let monthsPassed = 0; // Total full months passed since birth
        let targetBirthday = null; // For prime years calculation (not directly used now)
        let currentTheme = 'light';
        let timerIntervalId = null; // To store the interval ID

        // --- Configurable Settings (with defaults) ---
        let maxLifeYears = 80;
        let primeYearsStart = 0; // Prime years now start from 0
        let primeYearsEnd = 45;
        let awakeStartHour = 6; // Default 6 AM (now configurable)
        let awakeEndHour = 21; // Default 9 PM (now configurable)
        let primeAgeTarget = 45; // Redundant, use primeYearsEnd

        // --- Constants ---
        const MONTHS_IN_YEAR = 12;
        const WEEKS_IN_YEAR_APPROX = 52; // Approximation
        const HOURS_IN_DAY = 24;
        const SLOTS_PER_DAY = 48; // 24 hours * 2 slots/hour (NEW)
        const MINUTES_PER_SLOT = 30;
        const MS_PER_SECOND = 1000;
        const MS_PER_MINUTE = MS_PER_SECOND * 60;
        const MS_PER_HOUR = MS_PER_MINUTE * 60;
        const MS_PER_DAY = MS_PER_HOUR * 24;
        const MS_PER_WEEK = MS_PER_DAY * 7;
        const DEFAULT_BIRTH_DATE = "2000-01-01";
        const THEME_STORAGE_KEY = 'lifeTrackerTheme';
        const SETTINGS_STORAGE_KEY = 'lifeTrackerSettings';
        const NUM_GRADIENT_STEPS = 15; // Number of steps in unit gradients
        // SVG Icons for status
        const TICK_ICON_SVG = '<svg xmlns="http://www.w3.org/2000/svg" class="icon-tick" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>';
        const CROSS_ICON_SVG = '<svg xmlns="http://www.w3.org/2000/svg" class="icon-cross" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>';


        // --- Utility Functions ---
        function isLeapYear(year) { return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0); }
        function daysInYear(year) { return isLeapYear(year) ? 366 : 365; }

        /**
         * Calculates age in full years based on a Date object.
         * @param {Date} dob - The date of birth.
         * @returns {number|null} The calculated age or null if dob is invalid.
         */
        function calculateAge(dob) {
            if (!(dob instanceof Date) || isNaN(dob.getTime())) return null;
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const m = today.getMonth() - dob.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                age--;
            }
            return Math.max(0, age); // Ensure age is not negative
        }

        /**
         * Calculates the total number of full months passed since the birth date.
         * @param {Date} dob - The date of birth.
         * @returns {number} The number of full months passed (minimum 0).
         */
        function calculateMonthsPassed(dob) {
             if (!(dob instanceof Date) || isNaN(dob.getTime())) return 0;
             const today = new Date();
             const birth = new Date(dob); // Ensure it's a Date object
             let months = (today.getFullYear() - birth.getFullYear()) * 12;
             months -= birth.getMonth();
             months += today.getMonth();

             // Adjust if the current day of the month is before the birth day of the month
             if (today.getDate() < birth.getDate()) {
                 months--;
             }
             return Math.max(0, months); // Return 0 if negative
        }

        /**
         * Formats a Date object into YYYY-MM-DD string for input fields.
         * @param {Date} date - The date to format.
         * @returns {string} The formatted date string or empty string if invalid.
         */
        function formatDateForInput(date) {
            if (!(date instanceof Date) || isNaN(date.getTime())) { return ''; }
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        /**
         * Formats an hour (0-23) into AM/PM format.
         * @param {number} hour - The hour (0-23).
         * @returns {string} Formatted hour (e.g., "6 AM", "12 PM", "9 PM").
         */
        function formatHourAMPM(hour) {
            const h = hour % 12 === 0 ? 12 : hour % 12;
            const ampm = hour < 12 || hour === 24 ? 'AM' : 'PM'; // Handle midnight if needed
            return `${h} ${ampm}`;
        }

        // --- Settings Modal Functions ---
        function openSettingsModal() {
            // Populate modal with current settings values
            maxLifespanInput.value = maxLifeYears;
            primeEndAgeInput.value = primeYearsEnd;
            awakeStartHourInput.value = awakeStartHour;
            awakeEndHourInput.value = awakeEndHour;

            settingsStatus.textContent = ''; // Clear previous status messages
            settingsModal.classList.remove('hidden');
            modalOverlay.classList.remove('hidden');
            settingsModal.setAttribute('aria-hidden', 'false');
            modalOverlay.setAttribute('aria-hidden', 'false');
        }

        function closeSettingsModal() {
            settingsModal.classList.add('hidden');
            modalOverlay.classList.add('hidden');
            settingsModal.setAttribute('aria-hidden', 'true');
            modalOverlay.setAttribute('aria-hidden', 'true');
            settingsStatus.textContent = ''; // Clear status on close
        }


        // --- Settings Handling ---
        function loadSettings() {
            let savedSettings = {};
            const defaultSettings = {
                maxLifeYears: 80,
                primeYearsEnd: 45,
                awakeStartHour: 6,
                awakeEndHour: 21
            };
            try {
                const settingsString = localStorage.getItem(SETTINGS_STORAGE_KEY);
                if (settingsString) {
                    savedSettings = JSON.parse(settingsString);
                }
            } catch (e) {
                console.error("Error loading settings from local storage:", e);
                localStorage.removeItem(SETTINGS_STORAGE_KEY); // Clear potentially corrupted data
                savedSettings = {}; // Reset to empty to use defaults
            }

            // Parse and validate loaded settings, falling back to defaults
            maxLifeYears = parseInt(savedSettings.maxLifeYears, 10) || defaultSettings.maxLifeYears;
            primeYearsEnd = parseInt(savedSettings.primeYearsEnd, 10) || defaultSettings.primeYearsEnd;
            awakeStartHour = parseInt(savedSettings.awakeStartHour, 10);
            awakeEndHour = parseInt(savedSettings.awakeEndHour, 10);

            // Validate awake hours (handle NaN, range, order)
            if (isNaN(awakeStartHour) || awakeStartHour < 0 || awakeStartHour > 23) {
                awakeStartHour = defaultSettings.awakeStartHour;
            }
            if (isNaN(awakeEndHour) || awakeEndHour < 0 || awakeEndHour > 23) {
                awakeEndHour = defaultSettings.awakeEndHour;
            }
            if (awakeStartHour >= awakeEndHour) { // Ensure start is before end
                awakeStartHour = defaultSettings.awakeStartHour;
                awakeEndHour = defaultSettings.awakeEndHour;
            }

            primeYearsStart = 0; // Always start prime years at 0

            // Ensure other values are reasonable
            if (maxLifeYears <= 0) maxLifeYears = defaultSettings.maxLifeYears;
            if (primeYearsEnd <= 0) primeYearsEnd = defaultSettings.primeYearsEnd; // Prime end must be > 0
            if (primeYearsEnd > maxLifeYears) primeYearsEnd = Math.min(defaultSettings.primeYearsEnd, maxLifeYears);

            // Update input fields in the modal (will be done again in openSettingsModal, but good practice)
            maxLifespanInput.value = maxLifeYears;
            primeEndAgeInput.value = primeYearsEnd;
            awakeStartHourInput.value = awakeStartHour;
            awakeEndHourInput.value = awakeEndHour;

            // Update UI elements that depend on these settings
            updateSettingsDependentUI();
        }

        function saveSettings() {
            settingsStatus.textContent = ''; // Clear previous status
            const newMaxLife = parseInt(maxLifespanInput.value, 10);
            const newPrimeEnd = parseInt(primeEndAgeInput.value, 10);
            const newAwakeStart = parseInt(awakeStartHourInput.value, 10);
            const newAwakeEnd = parseInt(awakeEndHourInput.value, 10);

            // --- Validation ---
            let errorMessage = '';
            if (isNaN(newMaxLife) || newMaxLife <= 0) {
                errorMessage = 'Max Lifespan must be a positive number.';
            } else if (isNaN(newPrimeEnd) || newPrimeEnd <= 0) {
                errorMessage = 'Prime End Age must be greater than 0.';
            } else if (newPrimeEnd > newMaxLife) {
                errorMessage = 'Prime End Age cannot exceed Max Lifespan.';
            } else if (isNaN(newAwakeStart) || newAwakeStart < 0 || newAwakeStart > 23) {
                errorMessage = 'Awake Start Hour must be between 0 and 23.';
            } else if (isNaN(newAwakeEnd) || newAwakeEnd < 0 || newAwakeEnd > 23) {
                errorMessage = 'Awake End Hour must be between 0 and 23.';
            } else if (newAwakeStart >= newAwakeEnd) {
                errorMessage = 'Awake Start Hour must be before Awake End Hour.';
            }

            if (errorMessage) {
                settingsStatus.textContent = `Error: ${errorMessage}`;
                settingsStatus.style.color = 'var(--icon-cross-color)';
                return;
            }
            // --- End Validation ---

            // Update state variables
            maxLifeYears = newMaxLife;
            primeYearsEnd = newPrimeEnd;
            awakeStartHour = newAwakeStart;
            awakeEndHour = newAwakeEnd;
            primeYearsStart = 0; // Ensure start is always 0

            const settingsToSave = {
                maxLifeYears: maxLifeYears,
                primeYearsEnd: primeYearsEnd,
                awakeStartHour: awakeStartHour,
                awakeEndHour: awakeEndHour
            };

            // Save to localStorage
            try {
                localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(settingsToSave));
                settingsStatus.textContent = 'Settings saved!';
                settingsStatus.style.color = 'var(--icon-tick-color)'; // Use tick color for success

                // Update UI immediately
                updateSettingsDependentUI();
                updateUserInfo(); // Recalculate age-dependent info and re-render grids

                // Close modal after a short delay to show success message
                setTimeout(closeSettingsModal, 1500);

            } catch (e) {
                console.error("Error saving settings to local storage:", e);
                settingsStatus.textContent = 'Error saving settings.';
                settingsStatus.style.color = 'var(--icon-cross-color)';
            }
        }

         /**
          * Updates UI elements (labels, tooltips) that depend on the settings.
          * This is called after loading or saving settings.
          */
         function updateSettingsDependentUI() {
             // Update progress grid labels
             if (lifespanProgressLabel) lifespanProgressLabel.textContent = `Overall Life Progress (Months)`;
             if (lifespanYearProgressLabel) lifespanYearProgressLabel.textContent = `Overall Life Progress (Years)`;
             if (primeProgressLabel) primeProgressLabel.textContent = `Prime Years Progress (Months)`;

             // Update progress grid container tooltips
             const lifespanTooltip = `Shows your progress through your defined lifespan (${maxLifeYears * MONTHS_IN_YEAR} months). Each square is a month. Darker squares are more recent. The outlined square is the current month.`;
             const lifespanYearTooltip = `Shows your progress through your defined lifespan (${maxLifeYears} years). Each square is a year. Darker squares are more recent. The outlined square is the current year.`;
             const primeTooltip = `Shows how much of your prime working years (0-${primeYearsEnd * MONTHS_IN_YEAR} months) you have completed. Each square is a prime month. Darker squares are more recent. The outlined square is the current month.`;

             const lifespanWrapper = lifespanContribGrid?.closest('.contrib-grid-wrapper');
             const lifespanYearWrapper = lifespanYearContribGrid?.closest('.contrib-grid-wrapper');
             const primeWrapper = primeContribGrid?.closest('.contrib-grid-wrapper');

             if (lifespanWrapper) lifespanWrapper.title = lifespanTooltip;
             if (lifespanYearWrapper) lifespanYearWrapper.title = lifespanYearTooltip;
             if (primeWrapper) primeWrapper.title = primeTooltip;

             // Update prime countdown tiles and header tooltips
             const primeYearsTile = primeYearsLeftSpan?.closest('.tile');
             const primeWeeksTile = primeWeeksLeftSpan?.closest('.tile');
             const primeMonthsTile = primeMonthsLeftSpan?.closest('.tile');
             if (primeYearsTile) primeYearsTile.title = `Full years remaining until the end of your prime period (age ${primeYearsEnd}).`;
             if (primeWeeksTile) primeWeeksTile.title = `Approximate weeks remaining until the end of your prime period.`;
             if (primeMonthsTile) primeMonthsTile.title = `Full months remaining until the end of your prime period.`;

             const primeCountdownHeader = primeYearsTile?.closest('.flex-1')?.querySelector('.time-group-label');
             if(primeCountdownHeader) primeCountdownHeader.title = `Time remaining in your prime working years (defined as 0-${primeYearsEnd}).`;

             // Update tooltips for the unit grids (ensure they reflect current settings)
             const yearWeeksWrapper = yearWeeksContribGrid?.closest('.contrib-grid-wrapper');
             if (yearWeeksWrapper) yearWeeksWrapper.title = `Visual representation of weeks remaining this year. Each square is a week. Brighter squares are further in the future. The highlighted square is the upcoming week.`;
             const yearMonthsWrapper = yearMonthsContribGrid?.closest('.contrib-grid-wrapper');
             if (yearMonthsWrapper) yearMonthsWrapper.title = `Visual representation of months remaining this year. Each square is a month. Brighter squares are further in the future. The highlighted square is the upcoming month.`;
             const primeYearsGridWrapper = primeYearsContribGrid?.closest('.contrib-grid-wrapper');
             if (primeYearsGridWrapper) primeYearsGridWrapper.title = `Visual representation of years remaining in your prime period (0-${primeYearsEnd}). Each square is a year. Brighter squares are further in the future. The highlighted square is the upcoming prime year.`;

             // Update Awake Slots label and tooltip
             const awakeStartAMPM = formatHourAMPM(awakeStartHour);
             const awakeEndAMPM = formatHourAMPM(awakeEndHour);
             if (awakeSlotsGridLabel) awakeSlotsGridLabel.textContent = `Active Hours (${awakeStartAMPM} - ${awakeEndAMPM})`;
             if (awakeSlotsGridWrapper) awakeSlotsGridWrapper.title = `Visual representation of 30-minute slots from ${awakeStartAMPM} to ${awakeEndAMPM}. Past slots are dim, current slot is highlighted, future slots use a gradient.`;

             // NEW: Update Day Slots Grid Tooltip
             const daySlotsWrapper = daySlotsContribGrid?.closest('.contrib-grid-wrapper');
             if (daySlotsWrapper) daySlotsWrapper.title = `Visual representation of all 48 half-hour slots today. Past slots are dim, current slot is highlighted, future slots use a gradient.`;
         }


        // --- UI Update Functions for Birth Date Tile ---
        function showBirthDateDisplay() {
            birthDateInputGroup.classList.add('hidden');
            birthDateDisplay.classList.remove('hidden');
            birthDateError.textContent = ''; // Clear any previous error

            if (birthDate) {
                birthDateStatus.firstChild.textContent = 'Birth Date Set '; // Text node
                birthDateStatusIcon.innerHTML = TICK_ICON_SVG; // Set icon
                changeBirthDateBtn.textContent = 'Change Birth Date';
            } else {
                birthDateStatus.firstChild.textContent = 'Birth Date Not Set '; // Text node
                birthDateStatusIcon.innerHTML = CROSS_ICON_SVG; // Set icon
                changeBirthDateBtn.textContent = 'Set Birth Date';
            }
        }
        function showBirthDateInput() {
            birthDateDisplay.classList.add('hidden');
            birthDateInputGroup.classList.remove('hidden');
            birthDateInput.value = formatDateForInput(birthDate); // Pre-fill if date exists
            birthDateError.textContent = ''; // Clear error
            birthDateInput.focus(); // Focus the input field
        }

        // --- Core Update Functions ---

        /**
         * Updates the time displays, countdowns, and unit grids every second.
         */
        function updateTimers() {
            const now = new Date();
            const currentActualYear = now.getFullYear();
            const currentMonth = now.getMonth(); // 0-11
            const currentHour = now.getHours(); // 0-23
            const currentMinute = now.getMinutes(); // 0-59
            const currentSecond = now.getSeconds(); // 0-59
            const currentMillisecond = now.getMilliseconds(); // 0-999

            // Format date and time strings
            const dateString = now.toLocaleDateString([], { month: 'short', day: 'numeric', year: 'numeric' });
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });

            // Calculate time remaining in the year
            const endOfYear = new Date(currentActualYear, 11, 31, 23, 59, 59, 999);
            const msLeftYear = endOfYear - now;
            const daysLeftY = Math.max(0, Math.ceil(msLeftYear / MS_PER_DAY));
            const weeksLeftY = Math.max(0, Math.floor(daysLeftY / 7));
            const monthsLeftY = 11 - currentMonth; // Full months remaining

            // Calculate time remaining today
            const endOfDay = new Date(now);
            endOfDay.setHours(23, 59, 59, 999);
            const msLeftToday = endOfDay - now;
            const hoursLeft = Math.max(0, Math.floor(msLeftToday / MS_PER_HOUR));
            const minutesLeft = Math.max(0, Math.floor(msLeftToday / MS_PER_MINUTE));
            const secondsLeft = Math.max(0, Math.floor(msLeftToday / MS_PER_SECOND));

            // Calculate remaining prime time (only if age is known)
            let primeYearsLeftVal = '--';
            let primeWeeksLeftVal = '--';
            let primeMonthsLeftVal = '--';
            let totalPrimeYears = 0; // Total years in the prime period

            if (currentAge !== null && birthDate instanceof Date && !isNaN(birthDate.getTime())) {
                primeYearsLeftVal = Math.max(0, primeYearsEnd - currentAge); // Full years left until prime end age
                totalPrimeYears = primeYearsEnd - primeYearsStart; // Calculate total prime years duration

                try {
                    // Calculate target date for end of prime years
                    const birthYear = birthDate.getFullYear();
                    const birthMonth = birthDate.getMonth();
                    const birthDay = birthDate.getDate();
                    const targetPrimeBirthday = new Date(birthYear + primeYearsEnd, birthMonth, birthDay);

                    if (!isNaN(targetPrimeBirthday.getTime())) {
                        if (now < targetPrimeBirthday) {
                            const msLeftPrime = targetPrimeBirthday - now;
                            // Calculate weeks left until prime end
                            primeWeeksLeftVal = Math.max(0, Math.floor(msLeftPrime / MS_PER_WEEK));

                            // Calculate full months left until prime end
                            let yearsDiff = targetPrimeBirthday.getFullYear() - now.getFullYear();
                            let monthsDiff = targetPrimeBirthday.getMonth() - now.getMonth();
                            let daysDiff = targetPrimeBirthday.getDate() - now.getDate();
                            let totalMonths = yearsDiff * 12 + monthsDiff;
                            if (daysDiff < 0) {
                                totalMonths--; // Decrement if target day hasn't been reached this month
                            }
                            primeMonthsLeftVal = Math.max(0, totalMonths);

                        } else { // Prime period has ended
                            primeYearsLeftVal = 0;
                            primeWeeksLeftVal = 0;
                            primeMonthsLeftVal = 0;
                        }
                    } else {
                        console.error("Could not calculate target prime birthday (invalid date).");
                    }
                } catch (e) {
                    console.error("Error calculating target prime birthday:", e);
                }
            }

            // Calculate current 30-min slot number (1-48) and slots passed today
            const totalMinutesPassedToday = currentHour * 60 + currentMinute;
            const slotsPassedToday = Math.floor(totalMinutesPassedToday / MINUTES_PER_SLOT);
            const currentSlotNumber = slotsPassedToday + 1; // 1-based index for the current slot

            // Calculate current awake slot index (1-based) using configurable hours
            const totalAwakeSlots = Math.max(0, (awakeEndHour - awakeStartHour) * 2); // Calculate dynamically
            let currentAwakeSlotIndex = null; // Null if outside awake hours
            let remainingAwakeSlots = 0;

            if (currentHour >= awakeStartHour && currentHour < awakeEndHour) {
                const slotsPassedSinceStart = (currentHour - awakeStartHour) * 2 + (currentMinute >= 30 ? 1 : 0);
                currentAwakeSlotIndex = slotsPassedSinceStart + 1;
                remainingAwakeSlots = totalAwakeSlots - slotsPassedSinceStart;
            } else if (currentHour < awakeStartHour) {
                // Before awake start: All slots are remaining/future
                currentAwakeSlotIndex = 0; // Indicate before start
                remainingAwakeSlots = totalAwakeSlots;
            } else { // After awake end
                // awakeEndHour or later: All slots are completed/past
                currentAwakeSlotIndex = totalAwakeSlots + 1; // Indicate after end
                remainingAwakeSlots = 0;
            }

            // Calculate 30-minute slot countdown
            const minutesIntoCurrentSlot = totalMinutesPassedToday % MINUTES_PER_SLOT;
            const secondsIntoCurrentSlot = minutesIntoCurrentSlot * 60 + currentSecond;
            const msIntoCurrentSlot = secondsIntoCurrentSlot * 1000 + currentMillisecond;
            const msLeftInSlot = (MINUTES_PER_SLOT * MS_PER_MINUTE) - msIntoCurrentSlot;

            const countdownMinutes = Math.max(0, Math.floor(msLeftInSlot / MS_PER_MINUTE));
            const countdownSeconds = Math.max(0, Math.floor((msLeftInSlot % MS_PER_MINUTE) / MS_PER_SECOND));
            const formattedCountdown = `${countdownMinutes.toString().padStart(2, '0')}:${countdownSeconds.toString().padStart(2, '0')}`;


            // --- Update DOM Elements ---
            if (displayCurrentDateSpan) displayCurrentDateSpan.textContent = dateString;
            if (displayCurrentTimeSpan) displayCurrentTimeSpan.textContent = timeString;
            if (displayCurrentYearSpan) displayCurrentYearSpan.textContent = currentActualYear;

            if (yearCountdownTitle) yearCountdownTitle.textContent = `What's left for ${currentActualYear}`;
            if (todayCountdownTitle) todayCountdownTitle.textContent = `What's left for (${dateString})`;

            if (daysLeftYearSpan) daysLeftYearSpan.textContent = daysLeftY;
            if (weeksLeftYearSpan) weeksLeftYearSpan.textContent = weeksLeftY;
            if (monthsLeftYearSpan) monthsLeftYearSpan.textContent = monthsLeftY;
            if (hoursLeftDaySpan) hoursLeftDaySpan.textContent = hoursLeft;
            if (minutesLeftDaySpan) minutesLeftDaySpan.textContent = minutesLeft.toLocaleString();
            if (secondsLeftDaySpan) secondsLeftDaySpan.textContent = secondsLeft.toLocaleString();

            if (primeYearsLeftSpan) primeYearsLeftSpan.textContent = primeYearsLeftVal;
            if (primeWeeksLeftSpan) primeWeeksLeftSpan.textContent = primeWeeksLeftVal !== '--' ? primeWeeksLeftVal.toLocaleString() : '--';
            if (primeMonthsLeftSpan) primeMonthsLeftSpan.textContent = primeMonthsLeftVal !== '--' ? primeMonthsLeftVal.toLocaleString() : '--';

            if (slotCountdownSpan) slotCountdownSpan.textContent = formattedCountdown;
            if (slotsPassedTodaySpan) slotsPassedTodaySpan.textContent = `${slotsPassedToday} slots passed today`;

            // NEW: Update Day Slots Count Span
            if (daySlotsCount) daySlotsCount.textContent = `Slot ${currentSlotNumber} of ${SLOTS_PER_DAY}`;


            // --- Render Unit Contribution Grids ---
            const validWeeksLeftY = typeof weeksLeftY === 'number' && !isNaN(weeksLeftY) ? weeksLeftY : 0;
            const validMonthsLeftY = typeof monthsLeftY === 'number' && !isNaN(monthsLeftY) ? monthsLeftY : 0;
            const validHoursLeft = typeof hoursLeft === 'number' && !isNaN(hoursLeft) ? hoursLeft : 0;
            const validPrimeYearsLeft = typeof primeYearsLeftVal === 'number' && !isNaN(primeYearsLeftVal) ? primeYearsLeftVal : 0;
            const validRemainingAwakeSlots = typeof remainingAwakeSlots === 'number' && !isNaN(remainingAwakeSlots) ? remainingAwakeSlots : 0;
            const validCurrentSlotNumber = typeof currentSlotNumber === 'number' && !isNaN(currentSlotNumber) ? currentSlotNumber : 1; // Default to 1 if invalid


            // Calls to renderUnitGrid (using optimized function)
            renderUnitGrid('yearWeeksContribGrid', WEEKS_IN_YEAR_APPROX, validWeeksLeftY, 'Week', 'week');
            renderUnitGrid('yearMonthsContribGrid', MONTHS_IN_YEAR, validMonthsLeftY, 'Month', 'month');
            renderUnitGrid('todayHoursContribGrid', HOURS_IN_DAY, validHoursLeft, 'Hour', 'hour', currentHour + 1); // Pass current hour (1-24)
            renderUnitGrid('primeYearsContribGrid', totalPrimeYears, validPrimeYearsLeft, 'Prime Year', 'primeYear');
            renderUnitGrid('awakeSlotsContribGrid', totalAwakeSlots, validRemainingAwakeSlots, 'Awake Slot', 'awakeSlot', currentAwakeSlotIndex); // Pass dynamic total slots
            // NEW: Render Day Slots Grid
            renderUnitGrid('daySlotsContribGrid', SLOTS_PER_DAY, SLOTS_PER_DAY - validCurrentSlotNumber + 1, 'Day Slot', 'daySlot', validCurrentSlotNumber);


             // Update count spans for unit grids
             if (yearWeeksCountSpan) yearWeeksCountSpan.textContent = `(${validWeeksLeftY}/${WEEKS_IN_YEAR_APPROX})`;
             if (yearMonthsCountSpan) yearMonthsCountSpan.textContent = `(${validMonthsLeftY}/${MONTHS_IN_YEAR})`;
             if (todayHoursCountSpan) todayHoursCountSpan.textContent = `(${validHoursLeft}/${HOURS_IN_DAY})`;
             if (primeYearsCountSpan) primeYearsCountSpan.textContent = `(${validPrimeYearsLeft}/${totalPrimeYears > 0 ? totalPrimeYears : '--'})`; // Handle zero totalPrimeYears
             if (awakeSlotsCountSpan) awakeSlotsCountSpan.textContent = `(${validRemainingAwakeSlots}/${totalAwakeSlots > 0 ? totalAwakeSlots : '--'})`; // Use dynamic total
        }

        /**
         * Updates user info (age, months passed, contribution grids, percentages) based on the birth date and current settings.
         * Called on initialization, after setting birth date, or after changing settings.
         */
        function updateUserInfo() {
            let percentLifespanMonth = 0;
            let percentLifespanYear = 0;
            let percentPrime = 0;
            monthsPassed = 0; // Reset months passed

            if (birthDate instanceof Date && !isNaN(birthDate.getTime())) {
                currentAge = calculateAge(birthDate);
                monthsPassed = calculateMonthsPassed(birthDate); // Calculate total full months passed
                currentAgeSpan.textContent = currentAge !== null ? `${currentAge} years old` : '--';

                if (currentAge !== null) {
                    // Calculate percentages based on months passed
                    const totalLifespanMonths = maxLifeYears * MONTHS_IN_YEAR;
                    const totalPrimeMonths = (primeYearsEnd - primeYearsStart) * MONTHS_IN_YEAR; // primeYearsStart is 0

                    // Calculate lifespan percentage (Months)
                    percentLifespanMonth = totalLifespanMonths > 0
                        ? Math.max(0, Math.min(100, Math.round((monthsPassed / totalLifespanMonths) * 100)))
                        : 0;

                    // Calculate lifespan percentage (Years)
                    percentLifespanYear = maxLifeYears > 0
                        ? Math.max(0, Math.min(100, Math.round((currentAge / maxLifeYears) * 100)))
                        : 0;

                    // Calculate prime years percentage (Months)
                    const completedPrimeMonths = Math.max(0, Math.min(totalPrimeMonths, monthsPassed)); // Months passed within prime period
                    percentPrime = totalPrimeMonths > 0
                        ? Math.max(0, Math.min(100, Math.round((completedPrimeMonths / totalPrimeMonths) * 100)))
                        : 0;

                } else {
                    percentLifespanMonth = 0;
                    percentLifespanYear = 0;
                    percentPrime = 0;
                }
            } else { // No valid birth date set
                currentAgeSpan.textContent = '--';
                currentAge = null;
                percentLifespanMonth = 0;
                percentLifespanYear = 0;
                percentPrime = 0;
                monthsPassed = 0;
            }

             // Update Percentage Text display
             if (lifespanPercentText) lifespanPercentText.textContent = `${percentLifespanMonth}%`;
             if (lifespanYearPercentText) lifespanYearPercentText.textContent = `${percentLifespanYear}%`;
             if (primePercentText) primePercentText.textContent = `${percentPrime}%`;

            // Render the main progress Contribution Grids
            renderContributionGrids();

            // Update timers and unit grids immediately
            updateTimers();
        }

        // --- Rendering Functions ---

        /**
         * Renders the GitHub-style contribution grids for overall life (months & years) and prime years progress.
         * Optimized using DocumentFragment.
         */
        function renderContributionGrids() {
            // Check if all grid elements exist
            if (!lifespanContribGrid || !primeContribGrid || !lifespanYearContribGrid) {
                console.error("One or more contribution grid DOM elements not found");
                return;
            }

            const totalLifespanMonths = maxLifeYears * MONTHS_IN_YEAR;
            const totalPrimeMonths = (primeYearsEnd - primeYearsStart) * MONTHS_IN_YEAR; // primeYearsStart is 0
            const totalLifespanYears = maxLifeYears;

            // --- Render Lifespan Contribution Grid (Months) ---
            const lifespanMonthFragment = document.createDocumentFragment();
            for (let month = 1; month <= totalLifespanMonths; month++) {
                const square = document.createElement('div');
                square.classList.add('contrib-square');
                square.setAttribute('title', `Month ${month}`);

                if (monthsPassed > 0) {
                    if (month <= monthsPassed) {
                        const recencyMonths = monthsPassed - month;
                        let fillLevel = 0;
                        if (recencyMonths === 0) fillLevel = 20;
                        else if (recencyMonths === 1) fillLevel = 19;
                        else if (recencyMonths === 2) fillLevel = 18;
                        else if (recencyMonths === 3) fillLevel = 17;
                        else if (recencyMonths <= 6) fillLevel = 16;
                        else if (recencyMonths <= 9) fillLevel = 15;
                        else if (recencyMonths <= 12) fillLevel = 14;
                        else if (recencyMonths <= 18) fillLevel = 13;
                        else if (recencyMonths <= 24) fillLevel = 12;
                        else if (recencyMonths <= 36) fillLevel = 11;
                        else if (recencyMonths <= 48) fillLevel = 10;
                        else if (recencyMonths <= 60) fillLevel = 9;
                        else if (recencyMonths <= 84) fillLevel = 8;
                        else if (recencyMonths <= 120) fillLevel = 7;
                        else if (recencyMonths <= 180) fillLevel = 6;
                        else if (recencyMonths <= 240) fillLevel = 5;
                        else if (recencyMonths <= 300) fillLevel = 4;
                        else if (recencyMonths <= 360) fillLevel = 3;
                        else if (recencyMonths <= 480) fillLevel = 2;
                        else fillLevel = 1;

                        if (fillLevel > 0) {
                            square.classList.add(`lifespan-fill-level-${fillLevel}`);
                        }
                    }
                    if (month === monthsPassed) {
                        square.classList.add('current');
                    }
                }
                lifespanMonthFragment.appendChild(square);
            }
            lifespanContribGrid.innerHTML = '';
            lifespanContribGrid.appendChild(lifespanMonthFragment);

            // --- Render Lifespan Contribution Grid (Years) ---
            const lifespanYearFragment = document.createDocumentFragment();
            for (let year = 1; year <= totalLifespanYears; year++) {
                const square = document.createElement('div');
                square.classList.add('contrib-square');
                square.setAttribute('title', `Year ${year}`);

                if (currentAge !== null) {
                    if (year <= currentAge) {
                        const recencyYears = currentAge - year;
                        let fillLevel = 0;
                        if (recencyYears === 0) fillLevel = 20;
                        else if (recencyYears === 1) fillLevel = 19;
                        else if (recencyYears === 2) fillLevel = 18;
                        else if (recencyYears === 3) fillLevel = 17;
                        else if (recencyYears === 4) fillLevel = 16;
                        else if (recencyYears === 5) fillLevel = 15;
                        else if (recencyYears <= 7) fillLevel = 14;
                        else if (recencyYears <= 10) fillLevel = 13;
                        else if (recencyYears <= 12) fillLevel = 12;
                        else if (recencyYears <= 15) fillLevel = 11;
                        else if (recencyYears <= 18) fillLevel = 10;
                        else if (recencyYears <= 20) fillLevel = 9;
                        else if (recencyYears <= 25) fillLevel = 8;
                        else if (recencyYears <= 30) fillLevel = 7;
                        else if (recencyYears <= 35) fillLevel = 6;
                        else if (recencyYears <= 40) fillLevel = 5;
                        else if (recencyYears <= 45) fillLevel = 4;
                        else if (recencyYears <= 50) fillLevel = 3;
                        else if (recencyYears <= 60) fillLevel = 2;
                        else fillLevel = 1;

                        if (fillLevel > 0) {
                            square.classList.add(`lifespan-fill-level-${fillLevel}`);
                        }
                    }
                    if (year === currentAge) {
                        square.classList.add('current');
                    }
                }
                lifespanYearFragment.appendChild(square);
            }
            lifespanYearContribGrid.innerHTML = '';
            lifespanYearContribGrid.appendChild(lifespanYearFragment);

            // --- Render Prime Years Contribution Grid (Months) ---
            const primeFragment = document.createDocumentFragment();
            if (totalPrimeMonths > 0) {
                for (let month = 1; month <= totalPrimeMonths; month++) {
                    const square = document.createElement('div');
                    square.classList.add('contrib-square');
                    square.setAttribute('title', `Prime Month ${month}`);

                    if (monthsPassed > 0) {
                        if (month <= monthsPassed) {
                             const recencyMonths = monthsPassed - month;
                             let fillLevel = 0;
                             if (recencyMonths === 0) fillLevel = 20;
                             else if (recencyMonths === 1) fillLevel = 19;
                             else if (recencyMonths === 2) fillLevel = 18;
                             else if (recencyMonths === 3) fillLevel = 17;
                             else if (recencyMonths <= 6) fillLevel = 16;
                             else if (recencyMonths <= 9) fillLevel = 15;
                             else if (recencyMonths <= 12) fillLevel = 14;
                             else if (recencyMonths <= 18) fillLevel = 13;
                             else if (recencyMonths <= 24) fillLevel = 12;
                             else if (recencyMonths <= 36) fillLevel = 11;
                             else if (recencyMonths <= 48) fillLevel = 10;
                             else if (recencyMonths <= 60) fillLevel = 9;
                             else if (recencyMonths <= 84) fillLevel = 8;
                             else if (recencyMonths <= 120) fillLevel = 7;
                             else if (recencyMonths <= 180) fillLevel = 6;
                             else if (recencyMonths <= 240) fillLevel = 5;
                             else if (recencyMonths <= 300) fillLevel = 4;
                             else if (recencyMonths <= 360) fillLevel = 3;
                             else if (recencyMonths <= 480) fillLevel = 2;
                             else fillLevel = 1;

                             if (fillLevel > 0) {
                                square.classList.add(`prime-fill-level-${fillLevel}`);
                             }
                        }
                         if (month === monthsPassed) {
                             square.classList.add('current');
                         }
                    }
                    primeFragment.appendChild(square);
                }
                primeContribGrid.innerHTML = '';
                primeContribGrid.appendChild(primeFragment);
            } else {
                 primeContribGrid.innerHTML = '<p class="text-xs text-center col-span-full" style="color: var(--text-muted-color);">Prime period ends at age 0.</p>';
            }
        }


        /**
         * Renders a GitHub-style contribution grid for remaining time units with gradients.
         * Optimized using DocumentFragment.
         * @param {string} containerId - The ID of the div element to render into.
         * @param {number} totalUnits - The total number of units in the period (e.g., 52 weeks, 24 hours, 48 slots).
         * @param {number} remainingUnits - The number of units remaining (used for gradient calculation).
         * @param {string} unitLabel - A base label for the unit (e.g., "Week", "Hour", "Slot").
         * @param {string} unitType - The type of unit ('week', 'month', 'hour', 'primeYear', 'awakeSlot', 'daySlot') for CSS class selection.
         * @param {number|null} [currentUnitIndex=null] - The 1-based index of the current unit (e.g., current hour, current slot). Used to determine past/current/future. Boundary values (0, total+1) can indicate before/after the period.
         */
        function renderUnitGrid(containerId, totalUnits, remainingUnits, unitLabel, unitType, currentUnitIndex = null) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Unit grid container with ID "${containerId}" not found.`);
                return;
            }

            // Ensure counts are valid numbers
            const validTotal = Math.max(0, Math.floor(totalUnits || 0));
            const validRemaining = Math.max(0, Math.floor(remainingUnits || 0));
            const validCurrentIndex = currentUnitIndex !== null ? Math.floor(currentUnitIndex) : null; // Allow 0 or total+1

            if (validTotal === 0) {
                container.innerHTML = '<p class="text-xs text-center col-span-full" style="color: var(--text-muted-color);">No units to display.</p>'; // Clear if total is zero and show message
                return;
            }

            const completedUnits = validTotal - validRemaining;
            const fragment = document.createDocumentFragment(); // Use fragment

            for (let i = 1; i <= validTotal; i++) {
                const square = document.createElement('div');
                square.classList.add('contrib-square');
                let titleText = `${unitLabel} ${i}`; // Base title
                let status = ''; // 'past', 'current', 'future'

                // --- Determine Status (Past, Current, Future) ---
                if (validCurrentIndex !== null) {
                    if (i < validCurrentIndex) {
                        status = 'past';
                    } else if (i === validCurrentIndex) {
                        status = 'current';
                    } else {
                        status = 'future';
                    }
                    // Handle boundary cases for awake slots
                    if (unitType === 'awakeSlot') {
                        if (validCurrentIndex === 0) status = 'future'; // Before awake start
                        if (validCurrentIndex > validTotal) status = 'past'; // After awake end
                    }
                } else {
                    // Default logic for grids without a specific 'current' index (like weeks, months, prime years)
                    if (i <= completedUnits) {
                        status = 'past';
                    } else if (i === completedUnits + 1) {
                        status = 'current'; // Treat the first future unit as 'current' for highlighting
                    } else {
                        status = 'future';
                    }
                }

                // --- Apply Styles and Title ---
                if (status === 'past') {
                    titleText += ' (Completed)';
                    if (unitType === 'hour') titleText = `Hour ${i-1}:00-${i}:00 (Past)`;
                    if (unitType === 'awakeSlot') {
                         const slotStartHour = awakeStartHour + Math.floor((i - 1) / 2);
                         const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                         const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                         const slotEndMin = slotStartMin === '30' ? '00' : '30';
                         titleText = `Awake Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Past)`;
                    }
                    // NEW: Title for Day Slots
                    if (unitType === 'daySlot') {
                        const slotStartHour = Math.floor((i - 1) / 2);
                        const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                        const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                        const slotEndMin = slotStartMin === '30' ? '00' : '30';
                        titleText = `Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Past)`;
                    }

                } else if (status === 'current') {
                    square.classList.add('unit-current'); // Highlight style
                    titleText += ' (Current)';
                     if (unitType === 'hour') titleText = `Hour ${i-1}:00-${i}:00 (Current)`;
                     if (unitType === 'awakeSlot') {
                         const slotStartHour = awakeStartHour + Math.floor((i - 1) / 2);
                         const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                         const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                         const slotEndMin = slotStartMin === '30' ? '00' : '30';
                         titleText = `Awake Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Current)`;
                     }
                     // NEW: Title for Day Slots
                     if (unitType === 'daySlot') {
                        const slotStartHour = Math.floor((i - 1) / 2);
                        const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                        const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                        const slotEndMin = slotStartMin === '30' ? '00' : '30';
                        titleText = `Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Current)`;
                     }
                     if (unitType === 'week' || unitType === 'month' || unitType === 'primeYear') {
                         titleText += ' - Upcoming';
                     }

                } else { // Future
                    // Apply gradient fill
                    const relativeIndex = i - (validCurrentIndex !== null ? validCurrentIndex : completedUnits); // Index relative to current/completed
                    const totalFutureUnits = validRemaining; // Total number of future units

                    if (totalFutureUnits > 0) { // Avoid division by zero
                         // Use the specific unitType for class name
                         const gradientLevel = Math.max(1, Math.min(NUM_GRADIENT_STEPS, Math.ceil(relativeIndex / totalFutureUnits * NUM_GRADIENT_STEPS)));
                         square.classList.add(`unit-${unitType}-fill-${gradientLevel}`);
                    }
                    titleText += ' (Future)';
                    if (unitType === 'hour') titleText = `Hour ${i-1}:00-${i}:00 (Future)`;
                    if (unitType === 'awakeSlot') {
                         const slotStartHour = awakeStartHour + Math.floor((i - 1) / 2);
                         const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                         const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                         const slotEndMin = slotStartMin === '30' ? '00' : '30';
                         titleText = `Awake Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Future)`;
                    }
                    // NEW: Title for Day Slots
                    if (unitType === 'daySlot') {
                        const slotStartHour = Math.floor((i - 1) / 2);
                        const slotStartMin = (i - 1) % 2 === 0 ? '00' : '30';
                        const slotEndHour = slotStartMin === '30' ? slotStartHour + 1 : slotStartHour;
                        const slotEndMin = slotStartMin === '30' ? '00' : '30';
                        titleText = `Slot ${i} (${formatHourAMPM(slotStartHour)}:${slotStartMin}-${formatHourAMPM(slotEndHour)}:${slotEndMin}) (Future)`;
                    }
                }

                square.setAttribute('title', titleText); // Set the final title
                fragment.appendChild(square); // Append to fragment
            }

            container.innerHTML = ''; // Clear existing grid content efficiently
            container.appendChild(fragment); // Append fragment once
        }

        // --- Theme Switching Logic ---
        function applyTheme(themeName) {
            // Remove all potential theme classes
            bodyElement.classList.remove('dark-mode', 'colorful-mode', 'cyberpunk-mode', 'dark-ocean-mode',
        'dark-forest-mode',
        'kids-rainbow-mode',
        'kids-space-mode',
        'twilight-dusk-mode',
        'twilight-dawn-mode',
        'cyberpunk-neon-mode');

            // Add the specific theme class
            if (themeName === 'dark') {
                bodyElement.classList.add('dark-mode');
            } else if (themeName === 'colorful') {
                bodyElement.classList.add('colorful-mode');
            } else if (themeName === 'cyberpunk') { // NEW: Handle cyberpunk
                bodyElement.classList.add('cyberpunk-mode');
            } else if (themeName === 'dark-ocean') {
         bodyElement.classList.add('dark-ocean-mode');
    } else if (themeName === 'dark-forest') {
         bodyElement.classList.add('dark-forest-mode');
    } else if (themeName === 'kids-rainbow') {
         bodyElement.classList.add('kids-rainbow-mode');
    } else if (themeName === 'kids-space') {
         bodyElement.classList.add('kids-space-mode');
    } else if (themeName === 'twilight-dusk') {
         bodyElement.classList.add('twilight-dusk-mode');
    } else if (themeName === 'twilight-dawn') {
         bodyElement.classList.add('twilight-dawn-mode');
    } else if (themeName === 'cyberpunk-neon') {
         bodyElement.classList.add('cyberpunk-neon-mode');
    }
            // 'light' theme is the default (no class added)

            // Update active state on theme buttons
            themeButtons.forEach(button => {
                button.classList.toggle('active', button.dataset.theme === themeName);
            });

            currentTheme = themeName; // Store current theme
            // Save theme preference to local storage
            try {
                localStorage.setItem(THEME_STORAGE_KEY, themeName);
            } catch (e) {
                console.error("Could not save theme preference to local storage:", e);
            }
        }

        function loadThemePreference() {
            let savedTheme = 'light'; // Default theme
            try {
                savedTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'light';
            } catch (e) {
                console.error("Could not load theme preference from local storage:", e);
                savedTheme = 'light'; // Fallback on error
            }
            // Validate loaded theme (including cyberpunk)
            if (!['light', 'dark', 'colorful', 'cyberpunk','dark-ocean',
        'dark-forest',
        'kids-rainbow',
        'kids-space',
        'twilight-dusk',
        'twilight-dawn',
        'cyberpunk-neon'].includes(savedTheme)) {
                savedTheme = 'light';
            }
            applyTheme(savedTheme); // Apply the loaded or default theme
        }

        // --- Event Listeners ---
        changeBirthDateBtn.addEventListener('click', showBirthDateInput);

        saveBirthDateBtn.addEventListener('click', () => {
            const dateValue = birthDateInput.value;
            birthDateError.textContent = ''; // Clear previous error

            if (dateValue) {
                // Attempt to parse the date, adding T00:00:00 to avoid timezone interpretation issues
                const potentialBirthDate = new Date(dateValue + 'T00:00:00');
                // Validate the date
                if (!isNaN(potentialBirthDate.getTime()) && potentialBirthDate <= new Date()) {
                    birthDate = potentialBirthDate; // Update state
                    localStorage.setItem('birthDate', dateValue); // Save valid date string
                    updateUserInfo(); // Update calculations and UI
                    showBirthDateDisplay(); // Switch back to display mode
                } else if (potentialBirthDate > new Date()) {
                    birthDateError.textContent = 'Birth date cannot be in the future.';
                } else { // Invalid date format or value
                    console.error("Invalid date selected:", dateValue);
                    birthDateError.textContent = 'Please select a valid date.';
                }
            } else { // Input was cleared
                birthDate = null; // Clear state
                localStorage.removeItem('birthDate'); // Remove from storage
                updateUserInfo(); // Update calculations and UI
                showBirthDateDisplay(); // Switch back to display mode
            }
        });

        cancelBirthDateBtn.addEventListener('click', showBirthDateDisplay);

        // Theme switcher button listeners (now includes cyberpunk)
        themeButtons.forEach(button => {
            button.addEventListener('click', () => {
                applyTheme(button.dataset.theme);
            });
        });

        // Settings Modal Listeners
        if (settingsIconBtn) settingsIconBtn.addEventListener('click', openSettingsModal);
        if (closeSettingsModalBtn) closeSettingsModalBtn.addEventListener('click', closeSettingsModal);
        if (modalOverlay) modalOverlay.addEventListener('click', closeSettingsModal); // Close on overlay click
        if (saveSettingsBtn) saveSettingsBtn.addEventListener('click', saveSettings);

        // Close modal on Escape key press
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && !settingsModal.classList.contains('hidden')) {
                closeSettingsModal();
            }
        });


        // --- Initialization ---
        function initialize() {
            // 1. Load Settings first as they might affect calculations
            loadSettings();

            // 2. Load saved birth date or use default
            const savedBirthDate = localStorage.getItem('birthDate');
            const initialDateValue = savedBirthDate || DEFAULT_BIRTH_DATE;
            const potentialInitialDate = new Date(initialDateValue + 'T00:00:00');

            // Validate the loaded/default date before setting it
            if (!isNaN(potentialInitialDate.getTime())) {
                // Only set if valid, otherwise birthDate remains null
                birthDate = potentialInitialDate;
            } else {
                console.warn(`Invalid stored/default birth date (${initialDateValue}), using null.`);
                birthDate = null; // Ensure birthDate is null if invalid
                localStorage.removeItem('birthDate'); // Clear invalid stored date
            }

            // 3. Update birth date tile display based on loaded/validated date
            showBirthDateDisplay();

            // 4. Update user info (calculates age, percentages, renders grids)
            updateUserInfo(); // This now calls updateTimers internally

            // 5. Load theme preference
            loadThemePreference();

            // 6. Start the main timer interval (if not already running)
            if (timerIntervalId) {
                clearInterval(timerIntervalId); // Clear any existing interval
            }
            timerIntervalId = setInterval(updateTimers, MS_PER_SECOND); // Update every second

            console.log("Life Grid Initialized.");
        }

        // --- Run Initialization on DOMContentLoaded ---
        document.addEventListener('DOMContentLoaded', initialize);

    </script>
</body>
</html>
